{"version":3,"sources":["../../common/dist/index.js","../../common/dist/languages/index.js","../../common/dist/languages/RichLanguageFormat.js","../../common/dist/dialogs/index.js","../../common/dist/tools/index.js","../../common/dist/tools/StandardTools.js","../../common/dist/actions/index.js","../../common/dist/editor/index.js","../../language-json/dist/index.js","CodeTextArea/CodeTextArea.tsx","ProseMirror/ProseMirror.tsx","ViewSwitcher/ViewSwitcher.tsx","ProseMirrorToolbar/ProseMirrorToolbarContext.ts","ProseMirrorToolbarIconButton/ProseMirrorToolbarIconButton.tsx","ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown.tsx","ProseMirrorToolbarGroup/ProseMirrorToolbarGroup.tsx","RichTextEditor/RichTextEditorContext.tsx","ProseMirrorToolbar/ProseMirrorToolbar.tsx","RichTextEditor/DefaultToolbar.ts","AIPromptDialog/AIConfiguration.ts","AIPromptDialog/AIPromptDialogGraphic.tsx","AIPromptDialog/AIPromptDialog.tsx","RichTextActions/RichTextActionsImpl.tsx","AnchorDialog/AnchorDialog.tsx","CodeDialog/CodeDialog.tsx","HyperlinkDialog/HyperlinkDialog.tsx","ImageDialog/ImageDialog.tsx","RichTextDialogs/RichTextDialogsContext.ts","RichTextDialogs/RichTextAlert.tsx","RichTextDialogs/RichTextDialogsContainer.tsx","RichTextEditorAIActionsBar/RichTextEditorAIActionsBar.tsx","RichTextEditor/RichTextEditor.tsx","ProseMirrorToolbar/ProseMirrorToolbarState.ts","EditorRichTextField/EditorRichTextField.tsx","App.tsx","index.tsx","../../common/dist/tools/StandardToolOptions.js","../../common/dist/utils/ProseMirrorUtils.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkNode.js","../../prosemirror-dynamic-content/dist/InlineChooser/InlineChooser.js","../../prosemirror-dynamic-content/dist/DcImageLink/DcImageLinkView.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkNode.js","../../prosemirror-dynamic-content/dist/DcContentLink/contentSchemas.js","../../prosemirror-dynamic-content/dist/DcContentLink/DcContentLinkView.js","../../prosemirror-dynamic-content/dist/DynamicContentTools/DynamicContentTools.js","../../language-markdown/dist/alignment/AlignmentTools.js","../../language-markdown/dist/anchor/AnchorNode.js","../../language-markdown/dist/anchor/AnchorTool.js","../../language-markdown/dist/anchor/AnchorToMarkdown.js","../../language-markdown/dist/inline_styles/InlineStylesMark.js","../../language-markdown/dist/utils/MarkUtils.js","../../language-markdown/dist/inline_styles/InlineStylesTool.js","../../language-markdown/dist/inline_styles/InlineStylesToMarkdown.js","../../language-markdown/dist/alignment/RecursiveHtmlBlock.js","../../language-markdown/dist/soft_hyphen/SoftHyphenFromMarkdown.js","../../language-markdown/dist/soft_hyphen/SoftHyphenNode.js","../../language-markdown/dist/soft_hyphen/SoftHyphenToMarkdown.js","../../language-markdown/dist/markdown/MarkdownParser.js","../../language-markdown/dist/alignment/AlignmentPlugin.js","../../language-markdown/dist/tables/TableToMarkdown.js","../../language-markdown/dist/markdown/MarkdownSerializer.js","../../language-markdown/dist/schema/createSchema.js","../../language-markdown/dist/tables/TableTools.js","../../language-markdown/dist/MarkdownLanguage.js","../../language-markdown/dist/soft_hyphen/SoftHyphenTool.js","../../language-markdown/dist/MarkdownLanguageConfiguration.js","../../language-markdown/dist/index.js","../../language-json/dist/blocks/DcImageLinkBlock.js","../../language-json/dist/blocks/MarkdownBlock.js","../../language-json/dist/JSONLanguageConfiguration.js","../../language-json/dist/blocks/DcContentLinkBlock.js","../../language-json/dist/JSONLanguage.js"],"names":["RichLanguageFormat","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","Symbol","iterator","v","op","TypeError","pop","push","_a","require","undoFn","undo","redoFn","redo","_b","toggleMark","setBlockType","lift","wrapInList","findParentNode","createMarkToggleTool","name","icon","type","displayIcon","isActive","state","isMarkActive","editLink","_this","dispatch","richTextEditorContext","marks","attrs","linkValue","newAttrs","tr","selection","getSelectionMarks","filter","mark","undefined","dialogs","getHyperlink","cancel","href","title","from","to","addMark","create","removeMark","editCode","params","val","getCurrentParams","getCode","insertImage","imageValue","getImage","replaceSelectionWith","createAndFill","src","alt","parent","x","node","blockTypeCommand","align","getCurrentAlignment","heading","schema","level","displayLabel","React","createElement","style","margin","nodes","isEnabled","view","createStandardTools","options","tools","isToolEnabled","Undo","Redo","strong","FormatBold","em","FormatItalic","code","Code","link","Link","empty","FormatIndentDecrease","isVisible","bullet_list","FormatListBulleted","ordered_list","FormatListNumbered","image","ImageIcon","blockquote","FormatQuote","paragraph","padding","display","code_block","horizontal_rule","CalendarViewDay","canInsert","FormatClearIcon","clearAllMarks","Badge","variant","badgeContent","color","overlap","Assistant","prompt_1","getAIPrompt","actions","insertAIContent","ai_generate","language","JSONLanguage","conf","JSONLanguageConfiguration","withStyles","root","flex","minHeight","maxHeight","textarea","outline","resize","backgroundColor","border","fontFamily","fontSize","props","classes","onChange","readOnly","handleChange","useCallback","event","target","className","EditorState","EditorView","exampleSetup","tableEditing","columnResizing","keymap","sinkListItem","getKeys","Tab","list_item","ProseMirror","ref","createRef","isLocked","doc","tablePlugins","table","plugins","menuBar","onUpdateState","editorState","createEditorState","self","editorViewOptions","dispatchTransaction","transaction","applyTransaction","transactions","updateState","some","docChanged","forceUpdate","editable","_props","bind","editorView","createEditorView","current","setState","prevProps","prevState","snapshot","Component","width","overflowY","button","transition","height","cursor","background","borderTop","borderBottom","fontWeight","selected","borderBottomColor","disableCodeView","disableEditView","useState","CODE","EDIT","selectedView","setSelectedView","renderButton","onClick","clsx","role","ProseMirrorToolbarContext","createContext","toolName","useContext","getToolState","applyTool","toolState","handleClick","focus","document","activeElement","setTimeout","visible","IconButton","onMouseDown","size","disabled","enabled","active","paddingLeft","paddingRight","toolNames","toolStates","map","selectedItems","find","test","renderValue","cloneElement","Select","displayEmpty","preventDefault","MenuItem","key","alignItems","divider","verticalAlign","lineHeight","borderRight","children","context","setIsLocked","locked","proseMirrorEditorView","languages","useRichTextEditorContext","layout","toolbarState","renderToolbarElement","element","findIndex","child","tool","toolVisible","Provider","areInlineStyles","keys","clearFormatting","disableGutters","DEFAULT_EDIT_PROMPTS","prompt","AIConfiguration","ai","model","editPrompts","frames","forEach","message","Array","fill","slice","AIPromptDialogGraphic","frame","setFrame","useEffect","nextFrame","interval","setInterval","clearInterval","xmlns","version","viewBox","id","maskType","maskUnits","rx","mask","d","mixBlendMode","stroke","strokeWidth","opacity","xmlSpace","fillOpacity","fontStretch","fontStyle","fontVariant","getText","x1","x2","y1","y2","gradientUnits","stopColor","offset","AIPromptDialogContent","onSubmit","setPrompt","strings","generate","placeholder","rewrite","handleSubmit","a","DialogTitle","paddingBottom","marginLeft","anchorOrigin","horizontal","vertical","betaBadge","DialogContent","TextField","onKeyUp","keyCode","InputProps","startAdornment","InputAdornment","position","endAdornment","Button","fullWidth","Typography","DialogActions","ConfigureAIDialogContent","onClose","configureContent","configureGraphic","getStartedAction","cancelAction","configure","overflow","justifyContent","paddingTop","maxWidth","right","top","borderRadius","open","configuration","getKey","Dialog","aria-labelledby","CHAT_MODELS","maxTokens","getSuitableModel","desiredModelName","estimatedConsumedTokens","desiredModel","rightSizeModel","invokeChatCompletions","onMessage","onError","estimatedInputTokens","messages","content","reduce","partialSum","markdownBuffer","fetchEventSource","headers","Authorization","method","JSON","stringify","getModel","max_tokens","stream","onmessage","data","delta","parse","choices","err","onopen","response","contentType","get","startsWith","json","Error","onerror","RichTextActionsImpl","datadogRum","addAction","cut","bodyMarkdown","serializeMarkdown","selectionMarkdown","handleInsertAIContent","formatRewritePrompt","payload","startPosition","endPosition","resolved","buffer","complete","isEmpty","isDialog","couldBeDialog","alert","updateContent","severity","fragment","parseMarkdown","trim","replaceWith","newState","Math","max","error","htmlIdRegex","AnchorDialog","existing","Set","setValue","lastValue","setLastValue","validate","checkValue","has","validateId","valid","validError","setValidError","handleInputChanged","fieldValue","newValue","reset","handleCancel","FormControl","autoFocus","required","helperText","FormHelperText","CodeDialog","HyperlinkDialog","isValid","setIsValid","validateUrl","handleClear","ImageDialog","theme","typography","body2","flexDirection","shape","success","darken","palette","main","lighten","info","warning","fontWeightMedium","header","marginRight","action","Close","alertId","RichTextDialogsContainer","openDialog","setOpenDialog","useReducer","alertIndex","splice","alerts","dispatchAlertEvent","handleCloseDialog","handleSubmitDialog","handleOpenDialog","sdk","SdkContext","handleUpdateAlertContent","handleCloseAlert","getAnchor","getDcImageLink","mediaLink","getDcContentLink","contentTypeIds","contentLink","dialogProps","alertProps","RichTextDialogsContext","Snackbar","autoHideDuration","bottom","chip","paper","primary","isAiToolEnabled","hasKey","Boolean","getEditPrompts","handleEditPrompt","rewriteSelectedContentUsingAI","handleCustomAiRewrite","Grid","direction","spacing","container","item","Chip","languagesProp","languageProp","toolbarLayoutProp","toolbarLayout","disableToolbar","readOnlyCodeView","valueProp","setProseMirrorEditorView","markdown","MarkdownLanguage","languageConfiguration","editorContext","setRichTextEditorContext","setView","format","rawValue","setRawValue","proseMirrorDocument","setProseMirrorDocument","handleRawValueChange","newProseMirrorDocument","handleEditorChange","newRawValue","serialize","setToolbarState","DefaultToolbar","handleEditorUpdateState","computeToolbarState","boxSizing","installation","instance","toolOptions","useMemo","settings","useClasses","classOverride","dynamicContent","stagingEnvironment","blacklist","nodeViews","getPos","DcImageLinkView","DcContentLinkView","styles","dangerouslySetInnerHTML","__html","stylesheet","rel","toolbar","codeView","App","connected","handleValueChange","handleChooseLink","handleConnect","handleInitRum","ddToken","process","REACT_APP_DATADOG_TOKEN","ddAppId","REACT_APP_DATADOG_APP_ID","ddEnv","REACT_APP_DATADOG_ENV_ID","init","applicationId","clientToken","env","site","service","trackResources","trackLongTasks","trackUserInteractions","defaultPrivacyLevel","sampleRate","useCrossSiteSessionCookie","startSessionReplayRecording","startAutoResizer","contentItem","getCurrent","setGlobalContext","deliveryId","field","getValue","withTheme","ReactDOM","render","getElementById","indexOf","whitelist","classNameRegex","getCustomClass","defaultName","name_1","getDefaultClass","customName","classes_1","inBlock","$from","depth","isInSet","storedMarks","rangeHasMark","$to","currentMarks","nodesBetween","pos","start","nodeSize","index","canReplaceWith","$cursor","ranges","_i","marks_1","removeStoredMark","ranges_1","range","_c","markName","DcImageLinkNode","group","defining","draggable","atom","parseDOM","tag","getAttrs","dom","getAttribute","toDOM","__rest","getOwnPropertySymbols","propertyIsEnumerable","aspectRatio","other","aspectRatioPaddingTop","components","split","round","Number","Fragment","ViewComponent","loading","broken","invalid","statusIcons","left","alignContent","onDelete","setBroken","setLoading","handleLoading","handleError","handleLoaded","hasValidValue","endpoint","Fab","StyledFab","InlineChooser","defaultHost","encodeURIComponent","onLoadStart","onLoad","CircularProgress","BrokenImageIcon","ChooserActions","DeleteIcon","handleDelete","delete","DcContentLinkNode","schemas","environments","virtual","boxShadow","backgroundSize","backgroundRepeat","backgroundPosition","contentName","fontsize","contentTypeName","contentLinkOptions","isArray","result_1","cards","icons","aspectRatios","setting","card","convertSettings","contentTypeSettings","customIcon","getContentTypeIcon","cardTemplateUrl","getContentTypeCard","schemaId","getContentTypeAspectRatio","backgroundImage","ContentItemIcon","textAlign","Visualization","template","contentItemId","xmlnsXlink","enableBackground","preserveAspectRatio","focusable","points","transform","beforeRender","createDynamicContentTools","ImageSearchIcon","dcImageLink","contentTypes","AddCircleIcon","dcContentLink","getContainingTextBlocks","resultNodes","isTextblock","add","alignment","setNodeMarkup","alignActive","anyMismatch","alignable","anchor","inline","insertAnchor","existingAnchors_1","addAnchor_1","anchorValue","AnchorToMarkdown","attrsSerialized","join","write","inline_styles","class","default","attributes","getMarkFromRange","markType","mergeAttrs","oldAttrs","inlineStyleClassNameTool","classLabel","existingMark","getStoredMark","addStoredMark","ref$1","ref$2","$from$1","$to$1","markAttrs","scrollIntoView","found","rangeHasFilteredMark","isFilteredMarkActive","m","InlineStylesToMarkdown","close","HTML_OPEN_CLOSE_TAG_RE","RegExp","HTML_SEQUENCES","source","html_block","startLine","endLine","silent","nextLine","token","lineText","bMarks","tShift","eMarks","sCount","blkIndent","md","html","charCodeAt","getLines","DOMParser","parseFromString","firstChild","innerContent","innerHTML","line","meta","tagName","soft_hyphen_from","soft_hyphen","SoftHyphenToMarkdown","markdownit","markdownItTable","createMarkdownParser","use","ruler","before","block","parser","MarkdownParser","defaultMarkdownParser","tokens","tok","attrGet","fence","noCloseToken","th","td","tokenHandlers","html_inline","endsWith","nodeName","toLowerCase","openMark","closeMark","addNode","hard_break","alignedParagraphTypes","Map","alignmentClasses","html_block_open","styleAttr","attr","alignAttr","ownerElement","classAttr","classList","asDefault","nodeType","openNode","html_block_close","closeNode","paragraph_align","getHeadingAttrs","heading_align","TableToMarkdown","rows","childCount","maybeChild","columnCount","closeBlock","table_row","_loop_1","out","substr","trimEnd","replace","padEnd","closed","withTableEscapes","renderInline","table_cell","table_header","TextToMarkdown","text","escape","createMarkdownSerializer","serializers","MarkdownSerializer","defaultMarkdownSerializer","AlignedParagraphToMarkdown","repeat","AlignedHeaderToMarkdown","tableNodes","Schema","inTable","path","$head","generateEmptyCell","fromArray","insertTable","__spreadArrays","il","r","k","j","jl","createMarkdownTools","concat","inlineStylesOptions","classNames","createInlineStylesTools","Directions","AnchorTool","Remove","SoftHyphenTool","FormatAlignLeft","FormatAlignCenter","FormatAlignRight","FormatAlignJustify","TableChart","CreateTableTool","BorderClear","deleteTable","VerticalAlignBottom","addRowAfter","LastPage","addColumnAfter","VerticalAlignTop","deleteRow","FirstPage","deleteColumn","createSchema","serializer","getNodeSerializers","canSerializeNodeToMarkdown","isInlineStylesEnabled","spec","addToEnd","append","tableGroup","cellContent","cellAttributes","getFromDOM","setDOMAttr","update","TEXT","MarkdownLanguageConfiguration","Node","DcImageLinkBlock","canSerialize","canParse","blocks","MarkdownBlock","markdownLanguage","parsedNodes","fromJSON","toJSON","DcContentLinkBlock","__extends","extendStatics","b","setPrototypeOf","__proto__","__","constructor","_super","blockTypes","markdownBlock","nodesByConverter","groupBy","blockType","nodesByConverter_1","groupBlocks","items","blocksGroupedByConverter","blocksGroupedByConverter_1","addBefore","groupFn","currentGroup","currentGroupItems","items_1","itemGroup"],"mappings":"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","file":"static/js/main.712a67f2.chunk.js","sourcesContent":["export * from \"./languages\";\nexport * from \"./dialogs\";\nexport * from \"./tools\";\nexport * from \"./utils\";\nexport * from \"./actions\";\nexport * from \"./editor\";\n","export * from \"./RichLanguage\";\nexport * from \"./RichLanguageConfiguration\";\nexport * from \"./RichLanguageFormat\";\nexport * from \"./RichTextLanguageMap\";\n","export var RichLanguageFormat;\n(function (RichLanguageFormat) {\n    RichLanguageFormat[\"TEXT\"] = \"text\";\n    RichLanguageFormat[\"JSON\"] = \"json\";\n})(RichLanguageFormat || (RichLanguageFormat = {}));\n","export * from \"./RichTextDialogs\";\n","export * from \"./ProseMirrorTool\";\nexport * from \"./ProseMirrorToolState\";\nexport * from \"./StandardTools\";\nexport * from \"./StandardToolOptions\";\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React from \"react\";\nimport { canInsert, clearAllMarks, getSelectionMarks, isMarkActive, } from \"../utils\";\n// tslint:disable:no-submodule-imports\nimport { Badge } from \"@material-ui/core\";\nimport Assistant from \"@material-ui/icons/Assistant\";\nimport CalendarViewDay from \"@material-ui/icons/CalendarViewDay\";\nimport Code from \"@material-ui/icons/Code\";\nimport FormatBold from \"@material-ui/icons/FormatBold\";\nimport FormatClearIcon from \"@material-ui/icons/FormatClear\";\nimport FormatIndentDecrease from \"@material-ui/icons/FormatIndentDecrease\";\nimport FormatItalic from \"@material-ui/icons/FormatItalic\";\nimport FormatListBulleted from \"@material-ui/icons/FormatListBulleted\";\nimport FormatListNumbered from \"@material-ui/icons/FormatListNumbered\";\nimport FormatQuote from \"@material-ui/icons/FormatQuote\";\nimport ImageIcon from \"@material-ui/icons/Image\";\nimport Link from \"@material-ui/icons/Link\";\nimport Redo from \"@material-ui/icons/Redo\";\nimport Undo from \"@material-ui/icons/Undo\";\nimport { isToolEnabled } from \"./StandardToolOptions\";\n// tslint:disable-next-line\nvar _a = require(\"prosemirror-history\"), undoFn = _a.undo, redoFn = _a.redo;\n// tslint:disable-next-line\nvar _b = require(\"prosemirror-commands\"), toggleMark = _b.toggleMark, setBlockType = _b.setBlockType, lift = _b.lift;\n// tslint:disable-next-line\nvar wrapInList = require(\"prosemirror-schema-list\").wrapInList;\n// tslint:disable-next-line\nvar findParentNode = require(\"prosemirror-utils\").findParentNode;\nexport function createMarkToggleTool(name, label, icon, type) {\n    return {\n        name: name,\n        label: label,\n        displayIcon: icon,\n        isActive: function (state) { return isMarkActive(state, type); },\n        apply: toggleMark(type),\n    };\n}\nexport function undo() {\n    return {\n        name: \"undo\",\n        label: \"Undo\",\n        displayIcon: React.createElement(Undo, null),\n        isEnabled: function (state) { return undoFn(state); },\n        apply: undoFn,\n    };\n}\nexport function redo() {\n    return {\n        name: \"redo\",\n        label: \"Redo\",\n        displayIcon: React.createElement(Redo, null),\n        isEnabled: function (state) { return redoFn(state); },\n        apply: redoFn,\n    };\n}\nexport function strong(schema) {\n    return createMarkToggleTool(\"strong\", \"Bold\", React.createElement(FormatBold, null), schema.marks.strong);\n}\nexport function em(schema) {\n    return createMarkToggleTool(\"em\", \"Italic\", React.createElement(FormatItalic, null), schema.marks.em);\n}\nexport function code(schema) {\n    return createMarkToggleTool(\"code\", \"Code\", React.createElement(Code, null), schema.marks.code);\n}\nexport function editLink(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var marks, attrs, linkValue, newAttrs, tr, selection, err_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    marks = getSelectionMarks(state).filter(function (mark) { return mark.mark.type === type; });\n                    attrs = marks.length === 1 ? marks[0].mark.attrs : undefined;\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getHyperlink(attrs)];\n                case 2:\n                    linkValue = _a.sent();\n                    if (linkValue.cancel) {\n                        return [2 /*return*/];\n                    }\n                    newAttrs = {\n                        href: linkValue.href,\n                        title: linkValue.title === \"\" ? undefined : linkValue.title,\n                    };\n                    if (marks.length > 0) {\n                        tr = state.tr, selection = state.selection;\n                        if (newAttrs.href !== \"\") {\n                            if (marks.length < 2 &&\n                                !(selection.from < marks[0].from || selection.to > marks[0].to)) {\n                                dispatch(tr.addMark(marks[0].from, marks[0].to, type.create(newAttrs)));\n                            }\n                            else {\n                                dispatch(tr.addMark(selection.from, selection.to, type.create(newAttrs)));\n                            }\n                        }\n                    }\n                    else {\n                        toggleMark(type, newAttrs)(state, dispatch);\n                    }\n                    return [2 /*return*/];\n                case 3:\n                    err_1 = _a.sent();\n                    return [3 /*break*/, 4];\n                case 4:\n                    if (isMarkActive(state, type)) {\n                        dispatch(state.tr.removeMark(marks[0].from, marks[0].to, type));\n                    }\n                    return [2 /*return*/];\n            }\n        });\n    }); };\n}\nexport function editCode(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var params, val, err_2;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    params = getCurrentParams(state, type);\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getCode(params.params || \"\")];\n                case 2:\n                    val = _a.sent();\n                    return [2 /*return*/, setBlockType(type, { params: val })(state, dispatch)];\n                case 3:\n                    err_2 = _a.sent();\n                    return [3 /*break*/, 4];\n                case 4: return [2 /*return*/];\n            }\n        });\n    }); };\n}\nexport function link(schema) {\n    return {\n        name: \"link\",\n        label: \"Add or remove Link\",\n        displayIcon: React.createElement(Link, null),\n        isActive: function (state) { return isMarkActive(state, schema.marks.link); },\n        isEnabled: function (state) {\n            return (!state.selection.empty ||\n                getSelectionMarks(state).filter(function (mark) { return mark.mark.type === schema.marks.link; }).length > 0);\n        },\n        apply: editLink(schema.marks.link),\n    };\n}\nexport function insertImage(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var imageValue, err_3;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getImage()];\n                case 1:\n                    imageValue = _a.sent();\n                    dispatch(state.tr.replaceSelectionWith(type.createAndFill({\n                        src: imageValue.src,\n                        title: imageValue.title === \"\" ? undefined : imageValue.title,\n                        alt: imageValue.alt === \"\" ? undefined : imageValue.alt,\n                    })));\n                    return [3 /*break*/, 3];\n                case 2:\n                    err_3 = _a.sent();\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    }); };\n}\nexport function image(schema) {\n    return {\n        name: \"image\",\n        label: \"Insert Image from URL\",\n        displayIcon: React.createElement(ImageIcon, null),\n        apply: insertImage(schema.nodes.image),\n    };\n}\nexport function lift_tool(schema) {\n    return {\n        name: \"lift\",\n        label: \"Decrease Indentation\",\n        displayIcon: React.createElement(FormatIndentDecrease, null),\n        isVisible: function (state) { return lift(state); },\n        apply: lift,\n    };\n}\nexport function bullet_list(schema) {\n    return {\n        name: \"bullet_list\",\n        label: \"Bullet List\",\n        displayIcon: React.createElement(FormatListBulleted, null),\n        isEnabled: function (state) { return wrapInList(schema.nodes.bullet_list, {})(state); },\n        apply: wrapInList(schema.nodes.bullet_list, {}),\n    };\n}\nexport function ordered_list(schema) {\n    return {\n        name: \"ordered_list\",\n        label: \"Ordered List\",\n        displayIcon: React.createElement(FormatListNumbered, null),\n        isEnabled: function (state) { return wrapInList(schema.nodes.ordered_list, {})(state); },\n        apply: wrapInList(schema.nodes.ordered_list, {}),\n    };\n}\nexport function blockquote(schema) {\n    return {\n        name: \"blockquote\",\n        label: \"Quote\",\n        displayIcon: React.createElement(FormatQuote, null),\n        isEnabled: function (state) { return wrapInList(schema.nodes.blockquote, {})(state); },\n        apply: wrapInList(schema.nodes.blockquote, {}),\n    };\n}\nfunction getCurrentAlignment(state) {\n    if (state == null) {\n        return {};\n    }\n    // Locate the block we're contained in.\n    var parent = findParentNode(function (x) { return x.attrs.align; })(state.selection);\n    if (parent != null) {\n        return { align: parent.node.attrs.align };\n    }\n    else {\n        return {};\n    }\n}\nfunction getCurrentParams(state, type) {\n    if (state == null || type.name !== \"code_block\") {\n        return {};\n    }\n    // Locate the block we're contained in.\n    var parent = findParentNode(function (x) { return x.attrs.params; })(state.selection);\n    if (parent != null) {\n        return { params: parent.node.attrs.params || \"\" };\n    }\n    else {\n        return { params: \"\" };\n    }\n}\nfunction blockTypeCommand(state, type, attrs) {\n    return setBlockType(type, __assign(__assign({}, attrs), getCurrentAlignment(state)));\n}\nexport function heading(schema, level) {\n    return {\n        name: \"heading_\" + level,\n        label: \"Heading \" + level,\n        displayLabel: React.createElement(\"h\" + level, { style: { margin: 0 } }, \"Heading \" + level),\n        apply: function (state, dispatch) {\n            return blockTypeCommand(state, schema.nodes.heading, { level: level })(state, dispatch);\n        },\n        isEnabled: function (state) {\n            return blockTypeCommand(state, schema.nodes.heading, { level: level })(state);\n        },\n        isActive: function (state, view) {\n            return !blockTypeCommand(state, schema.nodes.heading, { level: level })(state, null);\n        },\n    };\n}\nexport function paragraph(schema) {\n    var command = setBlockType(schema.nodes.paragraph);\n    return {\n        name: \"paragraph\",\n        label: \"Normal text\",\n        displayLabel: (React.createElement(\"p\", { style: { margin: 0, padding: 0, display: \"inline\" } }, \"Normal text\")),\n        apply: function (state, dispatch) {\n            return blockTypeCommand(state, schema.nodes.paragraph)(state, dispatch);\n        },\n        isEnabled: function (state) {\n            return blockTypeCommand(state, schema.nodes.paragraph)(state);\n        },\n        isActive: function (state) {\n            return !blockTypeCommand(state, schema.nodes.paragraph)(state, null);\n        },\n    };\n}\nexport function code_block(schema) {\n    return {\n        name: \"code_block\",\n        label: \"Code Block\",\n        displayLabel: React.createElement(\"code\", null, \"Code Block\"),\n        displayIcon: React.createElement(Code, null),\n        apply: editCode(schema.nodes.code_block),\n        isActive: function (state, richTextEditorContext) {\n            var params = getCurrentParams(state, schema.nodes.code_block);\n            return !setBlockType(schema.nodes.code_block, __assign({}, params))(state, null);\n        },\n    };\n}\nexport function horizontal_rule(schema) {\n    return {\n        name: \"horizontal_rule\",\n        label: \"Insert Horizontal Rule\",\n        displayIcon: React.createElement(CalendarViewDay, null),\n        apply: function (state, dispatch) {\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.horizontal_rule.create()));\n        },\n        isEnabled: function (state) { return canInsert(state, schema.nodes.horizontal_rule); },\n    };\n}\nexport function clear_formatting() {\n    return {\n        name: \"clear_formatting\",\n        label: \"Clear Formatting\",\n        displayIcon: React.createElement(FormatClearIcon, null),\n        apply: clearAllMarks(),\n        isEnabled: function (state) {\n            // are there any marks?\n            return true;\n        },\n    };\n}\nexport function ai_generate() {\n    var _this = this;\n    return {\n        name: \"ai\",\n        label: \"AI Assistant\",\n        displayIcon: (React.createElement(Badge, { variant: \"dot\", badgeContent: \"NEW\", color: \"error\", overlap: \"rectangle\" },\n            React.createElement(Assistant, { color: \"primary\" }))),\n        apply: function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n            var prompt_1, _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        _b.trys.push([0, 3, , 4]);\n                        return [4 /*yield*/, richTextEditorContext.dialogs.getAIPrompt({\n                                variant: \"generate\",\n                            })];\n                    case 1:\n                        prompt_1 = _b.sent();\n                        return [4 /*yield*/, richTextEditorContext.actions.insertAIContent(prompt_1)];\n                    case 2:\n                        _b.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        _a = _b.sent();\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); },\n        isEnabled: function (state) {\n            return true;\n        },\n    };\n}\nexport function createStandardTools(schema, options) {\n    var tools = [];\n    if (isToolEnabled(\"undo\", options)) {\n        tools.push(undo());\n    }\n    if (isToolEnabled(\"redo\", options)) {\n        tools.push(redo());\n    }\n    if (isToolEnabled(\"strong\", options) && schema.marks.strong) {\n        tools.push(strong(schema));\n    }\n    if (isToolEnabled(\"em\", options) && schema.marks.em) {\n        tools.push(em(schema));\n    }\n    if (isToolEnabled(\"code\", options) && schema.marks.code) {\n        tools.push(code(schema));\n    }\n    if (isToolEnabled(\"link\", options) && schema.marks.link) {\n        tools.push(link(schema));\n    }\n    if (isToolEnabled(\"lift\", options)) {\n        tools.push(lift_tool(schema));\n    }\n    if (isToolEnabled(\"bullet_list\", options) && schema.nodes.bullet_list) {\n        tools.push(bullet_list(schema));\n    }\n    if (isToolEnabled(\"ordered_list\", options) && schema.nodes.ordered_list) {\n        tools.push(ordered_list(schema));\n    }\n    if (isToolEnabled(\"image\", options) && schema.nodes.image) {\n        tools.push(image(schema));\n    }\n    if (isToolEnabled(\"blockquote\", options) && schema.nodes.blockquote) {\n        tools.push(blockquote(schema));\n    }\n    if (isToolEnabled(\"heading\", options) && schema.nodes.heading) {\n        for (var i = 1; i < 7; i++) {\n            tools.push(heading(schema, i));\n        }\n    }\n    if (isToolEnabled(\"paragraph\", options) && schema.nodes.paragraph) {\n        tools.push(paragraph(schema));\n    }\n    if (isToolEnabled(\"code_block\", options) && schema.nodes.code_block) {\n        tools.push(code_block(schema));\n    }\n    if (isToolEnabled(\"horizontal_rule\", options) &&\n        schema.nodes.horizontal_rule) {\n        tools.push(horizontal_rule(schema));\n    }\n    if (isToolEnabled(\"clear_formatting\", options)) {\n        tools.push(clear_formatting());\n    }\n    if (isToolEnabled(\"ai\", options)) {\n        tools.push(ai_generate());\n    }\n    return tools;\n}\n","export * from \"./RichTextActions\";\n","export * from \"./RichTextEditorContextProps\";\n","import JSONLanguage from \"./JSONLanguage\";\nimport JSONLanguageConfiguration from \"./JSONLanguageConfiguration\";\nexport default function (options) {\n    return {\n        language: new JSONLanguage(options),\n        conf: JSONLanguageConfiguration\n    };\n}\nexport * from \"./JSONLanguage\";\nexport * from \"./JSONLanguageConfiguration\";\nexport * from \"./blocks/Block\";\nexport * from \"./blocks/DcImageLinkBlock\";\nexport * from \"./blocks/MarkdownBlock\";\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent } from \"react\";\n\nconst styles = {\n  root: {\n    flex: 1,\n    display: \"flex\",\n    minHeight: 286,\n    maxHeight: 500\n  },\n  textarea: {\n    flex: 1,\n    outline: \"none\" as \"none\",\n    resize: \"none\" as \"none\",\n    backgroundColor: \"#f0f0f0\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    padding: \"10px 8px 0\",\n    fontFamily: \"roboto,monospace!important\",\n    fontSize: 13\n  }\n};\n\nexport interface CodeTextAreaProps extends WithStyles<typeof styles> {\n  readOnly?: boolean;\n  value: string;\n  onChange?: (value: string) => void;\n}\n\nconst CodeTextArea: React.SFC<CodeTextAreaProps> = (\n  props: CodeTextAreaProps\n) => {\n  const { classes, value, onChange, readOnly = false } = props;\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<HTMLTextAreaElement>) => {\n      if (onChange) {\n        onChange(event.target.value);\n      }\n    },\n    [onChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      <textarea\n        readOnly={readOnly}\n        className={classes.textarea}\n        value={value}\n        onChange={handleChange}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(CodeTextArea);\n","import React, { RefObject } from \"react\";\n\nimport \"./ProseMirror.scss\";\n\nimport { WithStyles, withStyles } from \"@material-ui/core\";\n\nimport RichTextEditorContext from \"../RichTextEditor/RichTextEditorContext\";\n\n// tslint:disable-next-line\nconst EditorState = require(\"prosemirror-state\").EditorState;\n// tslint:disable-next-line\nconst EditorView = require(\"prosemirror-view\").EditorView;\n// tslint:disable-next-line\nconst exampleSetup = require(\"prosemirror-example-setup\").exampleSetup;\n// tslint:disable-next-line\nconst { tableEditing, columnResizing } = require(\"prosemirror-tables\");\n// tslint:disable-next-line\nconst keymap = require(\"prosemirror-keymap\").keymap;\n// tslint:disable-next-line\nconst { sinkListItem } = require(\"prosemirror-schema-list\");\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    minHeight: 250,\n    maxHeight: 600,\n    overflowY: \"scroll\" as \"scroll\"\n  }\n};\n\nexport interface ProseMirrorProps extends WithStyles<typeof styles> {\n  schema: any;\n  doc?: any;\n  editorViewOptions?: any;\n  onUpdateState?: (state: any, editorView: any) => void;\n  onChange?: (doc: any) => void;\n  isLocked?: boolean;\n}\n\ninterface ProseMirrorState {\n  ref: RefObject<any>;\n  editorView?: any;\n  isLocked?: boolean;\n}\n\nfunction getKeys(schema: any): any {\n  return {\n    Tab: sinkListItem(schema.nodes.list_item)\n  };\n}\n\nclass ProseMirror extends React.Component<ProseMirrorProps, ProseMirrorState> {\n  constructor(props: ProseMirrorProps) {\n    super(props);\n    const ref = React.createRef();\n    this.state = { ref, isLocked: props.isLocked };\n  }\n\n  public createEditorState(): any {\n    const { schema, doc } = this.props;\n\n    const withTablePlugins = schema.nodes.table != null;\n    const tablePlugins = withTablePlugins\n      ? [columnResizing(), tableEditing()]\n      : [];\n\n    return EditorState.create({\n      schema,\n      doc,\n      plugins: [\n        ...tablePlugins,\n        keymap(getKeys(schema)),\n        ...exampleSetup({ schema, menuBar: false }) // can pass mapkeys to suppress some bindings\n      ]\n    });\n  }\n\n  public createEditorView(parent: any): any {\n    const { onUpdateState, onChange } = this.props;\n\n    const editorState = this.createEditorState();\n    // tslint:disable-next-line: no-this-assignment\n    const self = this;\n\n    const view = new EditorView(parent, {\n      ...this.props.editorViewOptions,\n      state: editorState,\n      dispatchTransaction: (transaction: any) => {\n        const { state, transactions } = view.state.applyTransaction(\n          transaction\n        );\n        view.updateState(state);\n\n        if (onUpdateState) {\n          onUpdateState(state, view);\n        }\n\n        if (transactions.some((tr: any) => tr.docChanged)) {\n          if (onChange) {\n            onChange(state.doc);\n          }\n        }\n\n        this.forceUpdate();\n        return state;\n      },\n      editable(): boolean {\n        return !self.state.isLocked;\n      }\n    });\n\n    if (onUpdateState) {\n      onUpdateState(view.state, view);\n    }\n\n    // TODO: Is there a cleaner way than this monkey patch for getting the updated state after a dispatch?\n    view.dispatch = function(this: any, tr: any): any {\n      const dispatchTransaction = this._props.dispatchTransaction;\n      if (dispatchTransaction) {\n        return dispatchTransaction.call(this, tr);\n      } else {\n        return this.updateState(this.state.apply(tr));\n      }\n    }.bind(view);\n\n    return view;\n  }\n\n  public componentDidMount(): void {\n    if (this.state.ref && !this.state.editorView) {\n      const editorView = this.createEditorView(this.state.ref.current);\n      this.setState({ editorView });\n    }\n  }\n\n  public componentDidUpdate(\n    prevProps: Readonly<ProseMirrorProps>,\n    prevState: Readonly<ProseMirrorState>,\n    snapshot?: any\n  ): void {\n    if (this.props.isLocked !== prevProps.isLocked) {\n      this.setState({ ...this.state, isLocked: this.props.isLocked });\n    }\n  }\n\n  public render(): React.ReactElement {\n    const { classes } = this.props;\n    return <div className={classes.root} ref={this.state.ref} />;\n  }\n}\n\nexport default withStyles(styles)(ProseMirror);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\n\nconst styles = {\n  root: {\n    display: \"flex\"\n  },\n  button: {\n    outline: \"none\" as \"none\",\n    transition: \"color 0.2s linear,border-bottom-color 0.2s linear\",\n    height: 40,\n    cursor: \"pointer\" as \"pointer\",\n    background: \"transparent\" as \"transparent\",\n    border: \"0 solid transparent\",\n    borderTop: \"3px solid transparent\",\n    borderBottom: \"3px solid transparent\",\n    fontSize: 13,\n    padding: \"0 15px\",\n    color: \"#999999\",\n    fontWeight: \"bold\" as \"bold\"\n  },\n  selected: {\n    color: \"#1EA7FD\",\n    borderBottomColor: \"#1EA7FD\"\n  }\n};\n\nexport interface ViewSwitcherProps extends WithStyles<typeof styles> {\n  disableCodeView?: boolean;\n  disableEditView?: boolean;\n\n  language?: string;\n  onChange?: (view: EditorView) => void;\n}\n\nexport enum EditorView {\n  EDIT = \"edit\",\n  CODE = \"code\"\n}\n\nconst ViewSwitcher = (props: ViewSwitcherProps) => {\n  const {\n    classes,\n    onChange,\n    language,\n    disableCodeView,\n    disableEditView\n  } = props;\n\n  const [selectedView, setSelectedView] = React.useState(\n    !disableEditView ? EditorView.EDIT : EditorView.CODE\n  );\n\n  const handleChange = React.useCallback(\n    (view: EditorView) => {\n      setSelectedView(view);\n      if (onChange) {\n        onChange(view);\n      }\n    },\n    [setSelectedView]\n  );\n\n  const renderButton = React.useCallback(\n    (label: string, view: EditorView) => {\n      return (\n        <button\n          onClick={() => handleChange(view)}\n          className={clsx(classes.button, {\n            [classes.selected]: selectedView === view\n          })}\n          type=\"button\"\n          role=\"tab\"\n        >\n          {label}\n        </button>\n      );\n    },\n    [selectedView, handleChange]\n  );\n\n  return (\n    <div className={classes.root}>\n      {disableEditView ? false : renderButton(\"Edit\", EditorView.EDIT)}\n      {disableCodeView\n        ? false\n        : renderButton(language || \"Code\", EditorView.CODE)}\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ViewSwitcher);\n","import React from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarContextInterface {\n  getToolState?(toolName: string): ProseMirrorToolState | undefined;\n  applyTool?(toolName: string): void;\n}\n\nconst ProseMirrorToolbarContext = React.createContext<\n  ProseMirrorToolbarContextInterface\n>({});\nexport default ProseMirrorToolbarContext;\n","import { IconButton, withStyles, WithStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nimport clsx from \"clsx\";\n\nexport interface ProseMirrorToolbarButtonProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {\n  toolName: string;\n  isLocked?: boolean;\n}\n\nconst styles = {\n  root: {\n    margin: \"1px\"\n  }\n};\n\nconst ProseMirrorToolbarIconButton: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolName, classes } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolState = getToolState ? getToolState(toolName) : null;\n  const handleClick = React.useCallback(\n    event => {\n      const focus = document.activeElement;\n      if (applyTool) {\n        applyTool(toolName);\n      }\n\n      // Focus will switch to the button, which is required to play the ripple effect.\n      // If we return it to the original element as soon as possible, the cursor will be in the same spot.\n      if (focus != null) {\n        setTimeout(() => (focus as HTMLElement).focus(), 0);\n      }\n    },\n    [toolName, applyTool]\n  );\n\n  if (!toolState || !toolState.visible) {\n    return null;\n  }\n\n  return (\n    <IconButton\n      className={clsx(classes.root)}\n      onMouseDown={handleClick}\n      size=\"small\"\n      disabled={!toolState.enabled || props.isLocked}\n      color={toolState.active ? \"primary\" : \"default\"}\n      title={toolState.label}\n    >\n      {toolState.displayIcon ? toolState.displayIcon : toolState.label}\n    </IconButton>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarIconButton);\n","import React, { ChangeEvent } from \"react\";\n\nimport { ProseMirrorToolState } from \"@dc-extension-rich-text/common\";\nimport { MenuItem, Select, WithStyles, withStyles } from \"@material-ui/core\";\nimport { ProseMirrorToolbarContext } from \"../ProseMirrorToolbar\";\n\nconst styles = {\n  value: {\n    fontSize: 14,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"unset\" as \"unset\"\n  }\n};\n\nexport interface ProseMirrorToolbarButtonProps\n  extends WithStyles<typeof styles> {\n  toolNames: string[];\n  label?: string;\n  isLocked?: boolean;\n}\n\nconst ProseMirrorToolbarDropdown: React.SFC<ProseMirrorToolbarButtonProps> = (\n  props: ProseMirrorToolbarButtonProps\n) => {\n  const { toolNames, classes, label } = props;\n\n  const { getToolState, applyTool } = React.useContext(\n    ProseMirrorToolbarContext\n  );\n\n  const toolStates = toolNames\n    .map(toolName => {\n      const toolState = getToolState ? getToolState(toolName) : null;\n      return toolState;\n    })\n    .filter(x => x != null) as ProseMirrorToolState[];\n\n  const selectedItems: ProseMirrorToolState[] = toolStates.filter(\n    x => x.active\n  );\n\n  const selected =\n    selectedItems && selectedItems.length > 1\n      ? selectedItems.find(x => /inline_styles/.test(x.name)) ||\n        selectedItems[0]\n      : selectedItems.find(x => x.active);\n\n  const value = selected ? selected.name : \"\";\n\n  const handleChange = React.useCallback(\n    (event: ChangeEvent<{ value: unknown }>) => {\n      if (applyTool) {\n        applyTool(event.target.value as string);\n      }\n    },\n    [applyTool]\n  );\n\n  // override renderValue so menu items can be styled\n  const renderValue = React.useCallback(\n    (toolName?: any) => {\n      if (!toolName) {\n        return label || \"\";\n      }\n\n      let toolState:\n        | { label: string; displayLabel?: React.ReactElement }\n        | undefined = getToolState ? getToolState(toolName) : undefined;\n\n      if (!toolState) {\n        toolState = { label: toolName };\n      }\n\n      if (toolState.displayLabel) {\n        return React.cloneElement(toolState.displayLabel, {\n          className: classes.value\n        });\n      }\n      return toolState.label;\n    },\n    [getToolState]\n  );\n\n  if (toolStates.length === 0) {\n    return null;\n  }\n\n  return (\n    <Select\n      value={value}\n      onChange={handleChange}\n      renderValue={renderValue}\n      displayEmpty={true}\n      onMouseDown={e => e.preventDefault()}\n      disabled={props.isLocked}\n    >\n      {toolStates.map(toolState => {\n        return (\n          <MenuItem\n            value={toolState.name}\n            key={toolState.name}\n            onMouseDown={e => e.preventDefault()}\n          >\n            {toolState.displayLabel ? (\n              toolState.displayLabel\n            ) : (\n              <span>{toolState.label}</span>\n            )}\n          </MenuItem>\n        );\n      })}\n    </Select>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarDropdown);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { PropsWithChildren } from \"react\";\n\nimport clsx from \"clsx\";\n\nconst styles = {\n  root: {\n    display: \"flex\",\n    alignItems: \"center\"\n  },\n  divider: {\n    verticalAlign: \"top\",\n    display: \"inline-flex\",\n    height: 13,\n    lineHeight: 13,\n    borderRight: \"1px solid rgb(218, 220, 224)\",\n    margin: \"9px 4px\"\n  },\n  empty: {\n    display: \"none\"\n  }\n};\n\nexport interface ProseMirrorToolbarGroupProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {}\n\nconst ProseMirrorToolbarGroup: React.SFC<ProseMirrorToolbarGroupProps> = (\n  props: ProseMirrorToolbarGroupProps\n) => {\n  const { children, classes } = props;\n\n  return (\n    <div\n      className={clsx(classes.root, {\n        [classes.empty]: !children\n      })}\n    >\n      {children}\n      <div className={classes.divider} />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbarGroup);\n","import { RichTextEditorContextProps } from \"@dc-extension-rich-text/common\";\nimport React, { useContext, useReducer } from \"react\";\n\nconst context = React.createContext<RichTextEditorContextProps>({\n  params: {},\n  isLocked: false,\n  setIsLocked: (locked: boolean) => {},\n  proseMirrorEditorView: undefined,\n  dialogs: {} as any,\n  actions: {} as any,\n  languages: {},\n  language: {} as any\n});\nexport default context;\n\nexport function useRichTextEditorContext(): RichTextEditorContextProps {\n  return useContext(context);\n}\n","import React from \"react\";\n\nimport {\n  Toolbar as MaterialToolbar,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\n\nimport { ProseMirrorToolbarContext } from \".\";\nimport { ProseMirrorToolbarIconButton } from \"../ProseMirrorToolbarIconButton\";\n\nimport ProseMirrorToolbarDropdown from \"../ProseMirrorToolbarDropdown/ProseMirrorToolbarDropdown\";\nimport { ProseMirrorToolbarGroup } from \"../ProseMirrorToolbarGroup\";\nimport { useRichTextEditorContext } from \"../RichTextEditor/RichTextEditorContext\";\nimport { ProseMirrorToolbarState } from \"./ProseMirrorToolbarState\";\n\nconst styles = {\n  root: {\n    minHeight: 35,\n    borderBottom: \"1px solid rgb(218, 220, 224)\"\n  }\n};\n\nexport interface ToolbarButton {\n  type: \"button\";\n  toolName: string;\n}\n\nexport interface ToolbarDropDown {\n  type: \"dropdown\";\n  label?: string;\n  toolNames: string[];\n}\n\nexport interface ToolbarGroup {\n  type: \"group\";\n  children: ToolbarElement[];\n}\n\nexport type ToolbarElement = ToolbarButton | ToolbarGroup | ToolbarDropDown;\n\nexport interface ProseMirrorToolbarProps extends WithStyles<typeof styles> {\n  toolbarState: ProseMirrorToolbarState | undefined;\n  layout: ToolbarElement[];\n  isLocked?: boolean;\n}\n\nconst ProseMirrorToolbar: React.SFC<ProseMirrorToolbarProps> = (\n  props: ProseMirrorToolbarProps\n) => {\n  const { classes, layout, toolbarState } = props;\n  const richTextEditorContext = useRichTextEditorContext();\n\n  const renderToolbarElement = (element: ToolbarElement) => {\n    switch (element.type) {\n      case \"button\":\n        return (\n          <ProseMirrorToolbarIconButton\n            toolName={element.toolName}\n            isLocked={props.isLocked}\n          />\n        );\n      case \"dropdown\":\n        return (\n          <ProseMirrorToolbarDropdown\n            toolNames={element.toolNames}\n            label={element.label}\n            isLocked={props.isLocked}\n          />\n        );\n      case \"group\":\n        const toolVisible = (tool: ToolbarButton): boolean => {\n          const state =\n            toolbarState == null\n              ? null\n              : toolbarState.toolStates[tool.toolName];\n          return state == null ? true : state.visible;\n        };\n\n        const anyVisible =\n          element.children.findIndex(\n            child => child.type !== \"button\" || toolVisible(child)\n          ) !== -1;\n        return anyVisible ? (\n          <ProseMirrorToolbarGroup>\n            {element.children.map(child => renderToolbarElement(child))}\n          </ProseMirrorToolbarGroup>\n        ) : null;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <ProseMirrorToolbarContext.Provider\n      value={{\n        applyTool: (toolName: string) => {\n          if (!toolbarState) {\n            return;\n          }\n\n          const tool = toolbarState.tools.find(x => x.name === toolName);\n          const areInlineStyles = Object.keys(toolbarState.toolStates).filter(\n            (x: any) =>\n              /inline_styles/.test(x) && toolbarState.toolStates[x].active\n          );\n          if (!tool) {\n            return;\n          }\n\n          if (areInlineStyles && areInlineStyles.length) {\n            const clearFormatting = toolbarState.tools.find(\n              x => x.name === \"clear_formatting\"\n            );\n\n            if (clearFormatting) {\n              clearFormatting.apply(\n                richTextEditorContext.proseMirrorEditorView.state,\n                richTextEditorContext.proseMirrorEditorView.dispatch,\n                richTextEditorContext\n              );\n            }\n          }\n\n          tool.apply(\n            richTextEditorContext.proseMirrorEditorView.state,\n            richTextEditorContext.proseMirrorEditorView.dispatch,\n            richTextEditorContext\n          );\n        },\n        getToolState: (toolName: string) => {\n          if (!toolbarState) {\n            return undefined;\n          }\n\n          return toolbarState.toolStates[toolName];\n        }\n      }}\n    >\n      <MaterialToolbar className={classes.root} disableGutters={true}>\n        {layout.map(value => {\n          return renderToolbarElement(value);\n        })}\n      </MaterialToolbar>\n    </ProseMirrorToolbarContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(ProseMirrorToolbar);\n","import { ToolbarElement } from \"../ProseMirrorToolbar\";\n\nexport default [\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"undo\" },\n      { type: \"button\", toolName: \"redo\" }\n    ]\n  },\n\n  {\n    type: \"dropdown\",\n    label: \"Styles\",\n    toolNames: [\n      \"paragraph\",\n      \"heading_1\",\n      \"heading_2\",\n      \"heading_3\",\n      \"heading_4\",\n      \"heading_5\",\n      \"heading_6\",\n      \"code_block\"\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"strong\" },\n      { type: \"button\", toolName: \"em\" },\n      { type: \"button\", toolName: \"soft_hyphen\" },\n      { type: \"button\", toolName: \"link\" },\n      { type: \"button\", toolName: \"anchor\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"align_left\" },\n      { type: \"button\", toolName: \"align_center\" },\n      { type: \"button\", toolName: \"align_right\" },\n      { type: \"button\", toolName: \"align_justify\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"lift\" },\n      { type: \"button\", toolName: \"bullet_list\" },\n      { type: \"button\", toolName: \"ordered_list\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"dc-image-link\" },\n      { type: \"button\", toolName: \"image\" },\n      { type: \"button\", toolName: \"dc-content-link\" },\n      { type: \"button\", toolName: \"blockquote\" },\n      { type: \"button\", toolName: \"code_block\" },\n      { type: \"button\", toolName: \"horizontal_rule\" },\n      { type: \"button\", toolName: \"table_create\" }\n    ]\n  },\n\n  {\n    type: \"group\",\n    children: [\n      { type: \"button\", toolName: \"table_row_add\" },\n      { type: \"button\", toolName: \"table_row_delete\" },\n      { type: \"button\", toolName: \"table_col_add\" },\n      { type: \"button\", toolName: \"table_col_delete\" },\n      { type: \"button\", toolName: \"table_delete\" },\n      { type: \"button\", toolName: \"clear_formatting\" }\n    ]\n  },\n\n  { type: \"button\", toolName: \"ai\" }\n] as ToolbarElement[];\n","const OPENAI_CHATGPT_DEFAULT_MODEL = \"gpt-3.5-turbo\";\n\nconst DEFAULT_EDIT_PROMPTS = [\n  {\n    label: \"Improve this\",\n    prompt: \"Improve this\"\n  },\n  {\n    label: \"Shorten this\",\n    prompt: \"Shorten this\"\n  },\n  {\n    label: \"Expand this\",\n    prompt: \"Expand this\"\n  }\n];\n\nexport interface AIEditPrompt {\n  label: string;\n  prompt: string;\n}\n\nexport class AIConfiguration {\n  private params: any;\n\n  constructor(params: any) {\n    this.params = params;\n  }\n\n  public getKey(): string | undefined {\n    return this.params?.tools?.ai?.key;\n  }\n\n  public getModel(): string {\n    return this.params?.tools?.ai?.model || OPENAI_CHATGPT_DEFAULT_MODEL;\n  }\n\n  public getEditPrompts(): AIEditPrompt[] {\n    return this.params?.tools?.ai?.editPrompts || DEFAULT_EDIT_PROMPTS;\n  }\n}\n","import React, { useEffect, useState } from \"react\";\n\nexport interface AIPromptDialogGraphicProps {\n  className?: string;\n}\n\nconst messages = [\n  \"Write me a blog post about...\",\n  \"Write a buying guide for...\",\n  \"Write an article about...\",\n  \"Create a list of...\"\n];\n\nconst frames: string[] = [];\nmessages.forEach(message => {\n  new Array(message.length).fill(\"\").forEach((_, length) => {\n    frames.push(message.slice(0, length));\n  });\n  new Array(10).fill(\"\").forEach(() => {\n    frames.push(message);\n  });\n});\n\nfunction getText(frame: number): string {\n  return frames[frame % frames.length];\n}\n\nconst AIPromptDialogGraphic: React.SFC<AIPromptDialogGraphicProps> = (\n  props: AIPromptDialogGraphicProps\n) => {\n  const [frame, setFrame] = useState(0);\n\n  useEffect(() => {\n    let nextFrame = frame;\n    const animateFrame = () => {\n      nextFrame++;\n      setFrame(nextFrame);\n    };\n    const interval = setInterval(animateFrame, 50);\n    return () => {\n      clearInterval(interval);\n    };\n  });\n\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"777\"\n      height=\"428\"\n      fill=\"none\"\n      version=\"1.1\"\n      viewBox=\"0 0 777 428\"\n      {...props}\n    >\n      <mask\n        id=\"mask0_1924_96628\"\n        style={{ maskType: \"alpha\" }}\n        width=\"777\"\n        height=\"428\"\n        x=\"0\"\n        y=\"0\"\n        maskUnits=\"userSpaceOnUse\"\n      >\n        <rect width=\"777\" height=\"428\" fill=\"#fff\" rx=\"20\" />\n      </mask>\n      <g mask=\"url(#mask0_1924_96628)\">\n        <path\n          fill=\"url(#paint0_linear_1924_96628)\"\n          d=\"M809.39 284.915a30.001 30.001 0 0014.971-25.964V156.712a30 30 0 00-14.969-25.962L721.216 79.7a30 30 0 00-30.061 0l-88.185 51.05A30 30 0 00588 156.713v102.238a30 30 0 0014.972 25.964l88.185 51.042a30.002 30.002 0 0030.057-.001l88.176-51.041z\"\n        />\n        <g style={{ mixBlendMode: \"screen\" }}>\n          <path\n            fill=\"#FFA980\"\n            d=\"M683.518 246.474A25 25 0 00696 224.833v-70.665c0-8.923-4.757-17.17-12.481-21.639L622.523 97.24a25 25 0 00-25.038 0l-61.003 35.289A25 25 0 00524 154.169v70.664a25.003 25.003 0 0012.483 21.641l61.003 35.284a25.001 25.001 0 0025.035-.001l60.997-35.283z\"\n          />\n        </g>\n        <path\n          stroke=\"url(#paint1_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M614.185 214.168L530.185 306.168\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint2_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M530.122 306.781L746.122 427.781\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint3_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M530 306.749L618 306.749\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint4_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M582.137 272.208L530.137 306.208\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint5_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M530.187 306.833L637.187 427.833\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint6_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M571.279 112.668L681.885 169.994\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint7_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M682.494 169.896L743.466 -70.061\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint8_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M682.494 170.022L659.718 85.02\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint9_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M635.637 128.601L681.937 170.03\"\n          opacity=\"0.5\"\n        />\n        <path\n          stroke=\"url(#paint10_linear_1924_96628)\"\n          strokeWidth=\"0.5\"\n          d=\"M682.528 169.819L771.711 35.148\"\n          opacity=\"0.5\"\n        />\n        <g opacity=\"0.95\">\n          <g style={{ mixBlendMode: \"screen\" }}>\n            <rect\n              width=\"264\"\n              height=\"42\"\n              x=\"524.5\"\n              y=\"167.499\"\n              fill=\"#EFF7FB\"\n              rx=\"3.5\"\n            />\n            <rect\n              width=\"264\"\n              height=\"42\"\n              x=\"524.5\"\n              y=\"167.499\"\n              stroke=\"url(#paint11_linear_1924_96628)\"\n              rx=\"3.5\"\n            />\n          </g>\n          <path\n            fill=\"#216083\"\n            d=\"M548.126 181.336c.248-.639 1.152-.639 1.399 0l.305.789a8.003 8.003 0 004.574 4.573l.788.305c.639.248.639 1.152 0 1.399l-.788.306a8 8 0 00-4.574 4.573l-.305.789c-.247.639-1.151.639-1.399 0l-.305-.789a7.998 7.998 0 00-4.573-4.573l-.789-.306c-.639-.247-.639-1.151 0-1.399l.789-.305a8.001 8.001 0 004.573-4.573l.305-.789z\"\n          />\n          <path\n            fill=\"#216083\"\n            d=\"M537.914 179.204a.5.5 0 01.933 0l.277.717c.305.787.928 1.41 1.715 1.715l.717.277a.5.5 0 010 .933l-.717.277a3.004 3.004 0 00-1.715 1.715l-.277.717a.5.5 0 01-.933 0l-.277-.717a3.004 3.004 0 00-1.715-1.715l-.717-.277a.5.5 0 010-.933l.717-.277a3.004 3.004 0 001.715-1.715l.277-.717z\"\n          />\n          <path\n            fill=\"#216083\"\n            d=\"M540.051 191.313a.5.5 0 01.933 0l.277.717a2.999 2.999 0 001.715 1.715l.717.278a.5.5 0 010 .933l-.717.277a3.002 3.002 0 00-1.715 1.715l-.277.717a.5.5 0 01-.933 0l-.277-.717a3.002 3.002 0 00-1.715-1.715l-.717-.277a.5.5 0 010-.933l.717-.278a2.999 2.999 0 001.715-1.715l.277-.717z\"\n          />\n          <text\n            xmlSpace=\"preserve\"\n            style={{}}\n            x=\"576.763\"\n            y=\"193.268\"\n            fill=\"#216083\"\n            fillOpacity=\"1\"\n            fontFamily=\"Arial\"\n            fontSize=\"12\"\n            fontStretch=\"normal\"\n            fontStyle=\"normal\"\n            fontVariant=\"normal\"\n            fontWeight=\"bold\"\n          >\n            <tspan\n              x=\"576.763\"\n              y=\"193.268\"\n              style={{ fontFamily: 'roboto, \"sans-serif\"' }}\n              fill=\"#216083\"\n              fillOpacity=\"1\"\n              fontFamily=\"roboto\"\n              fontSize=\"12\"\n              fontStretch=\"normal\"\n              fontStyle=\"normal\"\n              fontVariant=\"normal\"\n              fontWeight=\"normal\"\n            >\n              {getText(frame)}\n            </tspan>\n          </text>\n        </g>\n        <path\n          fill=\"url(#paint12_linear_1924_96628)\"\n          d=\"M560.515 331.335A15 15 0 00568 318.353v-26.705a15 15 0 00-7.484-12.981l-22.999-13.316a15 15 0 00-15.031-.001l-23.002 13.317A15 15 0 00492 291.648v26.705c0 5.353 2.853 10.3 7.485 12.982l23.002 13.314a15 15 0 0015.03 0l22.998-13.314z\"\n          opacity=\"0.45\"\n        />\n        <path\n          fill=\"url(#paint13_linear_1924_96628)\"\n          d=\"M555.013 230.2A17.999 17.999 0 00564 214.619V165.38a18 18 0 00-8.986-15.58l-42.498-24.587a17.997 17.997 0 00-18.027-.001L451.986 149.8A18.002 18.002 0 00443 165.381v49.238a17.998 17.998 0 008.988 15.581l42.502 24.584a18 18 0 0018.025 0l42.498-24.584z\"\n          opacity=\"0.25\"\n        />\n        <g fill=\"#EFF7FB\" opacity=\"0.75\">\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"240\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"248\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"256\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"264\" rx=\"2\" />\n          <rect width=\"76\" height=\"4\" x=\"625\" y=\"272\" rx=\"2\" />\n        </g>\n        <g fill=\"#EFF7FB\" opacity=\"0.45\">\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"116\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"124\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"132\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"140\" rx=\"2\" />\n          <rect width=\"76\" height=\"4\" x=\"625\" y=\"148\" rx=\"2\" />\n        </g>\n        <g fill=\"#B4C5F2\" opacity=\"0.75\">\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"287\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"295\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"303\" rx=\"2\" />\n          <rect width=\"123\" height=\"4\" x=\"625\" y=\"311\" rx=\"2\" />\n          <rect width=\"76\" height=\"4\" x=\"625\" y=\"319\" rx=\"2\" />\n        </g>\n        <g fill=\"#B4C5F2\" opacity=\"0.8\">\n          <path d=\"M655.072 45.965c.494-1.278 2.303-1.278 2.797 0l1.683 4.346a11.999 11.999 0 006.859 6.86l4.347 1.682c1.278.495 1.278 2.304 0 2.798l-4.347 1.682a11.998 11.998 0 00-6.859 6.86l-1.683 4.347c-.494 1.278-2.303 1.278-2.797 0l-1.683-4.347a11.997 11.997 0 00-6.86-6.86l-4.346-1.682c-1.278-.494-1.278-2.303 0-2.798l4.346-1.682a11.997 11.997 0 006.86-6.86l1.683-4.346z\" />\n          <path d=\"M638.072 68.421c.248-.639 1.152-.639 1.399 0l1.021 2.637a5.999 5.999 0 003.43 3.43l2.637 1.02c.639.248.639 1.152 0 1.4l-2.637 1.02a5.999 5.999 0 00-3.43 3.43l-1.021 2.637c-.247.64-1.151.64-1.399 0l-1.02-2.637a6.002 6.002 0 00-3.43-3.43l-2.637-1.02c-.639-.248-.639-1.152 0-1.4l2.637-1.02a6.001 6.001 0 003.43-3.43l1.02-2.637z\" />\n          <path d=\"M632.895 40.807c.247-.639 1.151-.639 1.398 0l1.021 2.637a6.002 6.002 0 003.43 3.43l2.637 1.02c.639.248.639 1.152 0 1.4l-2.637 1.02a6.001 6.001 0 00-3.43 3.43l-1.021 2.637c-.247.639-1.151.639-1.398 0l-1.021-2.637a6.001 6.001 0 00-3.43-3.43l-2.637-1.02c-.639-.248-.639-1.152 0-1.4l2.637-1.02a6.002 6.002 0 003.43-3.43l1.021-2.637z\" />\n        </g>\n      </g>\n      <defs id=\"defs176\">\n        <linearGradient\n          id=\"paint0_linear_1924_96628\"\n          x1=\"541.41\"\n          x2=\"759.841\"\n          y1=\"207.827\"\n          y2=\"185.701\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop104\" stopColor=\"#F88B8B\" />\n          <stop id=\"stop106\" offset=\"0.483\" stopColor=\"#D7A7BD\" />\n          <stop id=\"stop108\" offset=\"1\" stopColor=\"#B4C5F2\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint1_linear_1924_96628\"\n          x1=\"532.44\"\n          x2=\"612.22\"\n          y1=\"301.843\"\n          y2=\"214.466\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop111\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop113\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint2_linear_1924_96628\"\n          x1=\"737.338\"\n          x2=\"532.19\"\n          y1=\"424.293\"\n          y2=\"309.372\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop116\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop118\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint3_linear_1924_96628\"\n          x1=\"614.67\"\n          x2=\"531.091\"\n          y1=\"307.999\"\n          y2=\"307.999\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop121\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop123\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint4_linear_1924_96628\"\n          x1=\"531.42\"\n          x2=\"580.808\"\n          y1=\"303.875\"\n          y2=\"271.584\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop126\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop128\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint5_linear_1924_96628\"\n          x1=\"632.202\"\n          x2=\"530.578\"\n          y1=\"424.083\"\n          y2=\"309.162\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop131\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop133\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint6_linear_1924_96628\"\n          x1=\"677.124\"\n          x2=\"572.076\"\n          y1=\"168.935\"\n          y2=\"114.488\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop136\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop138\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint7_linear_1924_96628\"\n          x1=\"742.37\"\n          x2=\"684.461\"\n          y1=\"-60.673\"\n          y2=\"167.228\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop141\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop143\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint8_linear_1924_96628\"\n          x1=\"661.788\"\n          x2=\"683.419\"\n          y1=\"87.913\"\n          y2=\"168.644\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop146\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop148\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint9_linear_1924_96628\"\n          x1=\"679.351\"\n          x2=\"635.377\"\n          y1=\"169.393\"\n          y2=\"130.047\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop151\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop153\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint10_linear_1924_96628\"\n          x1=\"769.378\"\n          x2=\"684.676\"\n          y1=\"40.934\"\n          y2=\"168.839\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop156\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop158\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint11_linear_1924_96628\"\n          x1=\"778.972\"\n          x2=\"527.286\"\n          y1=\"209.999\"\n          y2=\"209.999\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop161\" stopColor=\"#fff\" />\n          <stop id=\"stop163\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint12_linear_1924_96628\"\n          x1=\"494.876\"\n          x2=\"567.057\"\n          y1=\"260.999\"\n          y2=\"260.999\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop166\" stopColor=\"#F88B8B\" />\n          <stop id=\"stop168\" offset=\"1\" stopColor=\"#B4C5F2\" />\n        </linearGradient>\n        <linearGradient\n          id=\"paint13_linear_1924_96628\"\n          x1=\"447.579\"\n          x2=\"562.499\"\n          y1=\"119.998\"\n          y2=\"119.998\"\n          gradientUnits=\"userSpaceOnUse\"\n        >\n          <stop id=\"stop171\" stopColor=\"#B4C5F2\" />\n          <stop id=\"stop173\" offset=\"1\" stopColor=\"#F88B8B\" />\n        </linearGradient>\n      </defs>\n    </svg>\n  );\n};\n\nexport default AIPromptDialogGraphic;\n","import { AIPromptDialogOptions } from \"@dc-extension-rich-text/common\";\nimport {\n  Badge,\n  Box,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  InputAdornment,\n  TextField,\n  Typography,\n  withStyles,\n  WithStyles\n} from \"@material-ui/core\";\nimport {\n  Assistant as AssistantIcon,\n  Clear as ClearIcon,\n  Settings as SettingsIcon\n} from \"@material-ui/icons\";\nimport clsx from \"clsx\";\nimport React, { useState } from \"react\";\nimport { AIConfiguration } from \"./AIConfiguration\";\nimport AIPromptDialogGraphic from \"./AIPromptDialogGraphic\";\n\nconst styles = {\n  root: {},\n  prompt: {},\n  configure: {\n    \"& .MuiDialogContent-root, & .MuiDialogTitle-root, & .MuiDialogActions-root\": {\n      backgroundColor: \"#002C42\",\n      color: \"white\",\n      paddingLeft: 30,\n      paddingRight: 30\n    },\n    \"& .MuiDialog-paper\": {\n      height: 290,\n      overflow: \"hidden\"\n    },\n    \"& .MuiDialogActions-root\": {\n      justifyContent: \"flex-start\",\n      paddingBottom: 30\n    },\n    \"& .MuiDialogTitle-root\": {\n      paddingTop: 30\n    }\n  },\n  configureContent: {\n    maxWidth: \"50%\"\n  },\n  configureGraphic: {\n    width: 550,\n    position: \"absolute\" as \"absolute\",\n    right: 0,\n    top: -60\n  },\n  betaBadge: {\n    \"& .MuiBadge-badge\": {\n      backgroundColor: \"#f78a8b\"\n    }\n  },\n  getStartedAction: {\n    backgroundColor: \"rgba(255,255,255,0.9)\",\n    borderRadius: 20,\n    padding: \"5px 15px\"\n  },\n  cancelAction: {\n    color: \"white\"\n  }\n};\n\ninterface AIPromptDialogProps\n  extends AIPromptDialogOptions,\n    WithStyles<typeof styles> {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: string) => void;\n  params: any;\n}\n\nconst AIPromptDialogContent: React.SFC<any> = (props: AIPromptDialogProps) => {\n  const { variant = \"generate\", onSubmit, classes } = props;\n  const [prompt, setPrompt] = useState(\"\");\n\n  const strings = {\n    generate: {\n      placeholder: \"Write a blog post about...\",\n      button: \"Generate\"\n    },\n    rewrite: {\n      placeholder: \"Rewrite this content in the style of...\",\n      button: \"Rewrite\"\n    }\n  }[variant];\n\n  const handlePromptChange = (event: any) => {\n    setPrompt(event.target.value);\n  };\n\n  const handleSubmit = async () => {\n    onSubmit(prompt);\n  };\n\n  const handleKeyUp = (event: any) => {\n    if (event.key === \"Enter\" || event.keyCode === 13) {\n      handleSubmit();\n    }\n  };\n\n  return (\n    <>\n      <DialogTitle style={{ paddingBottom: 0 }}>\n        AI Assistant\n        <Badge\n          style={{ marginLeft: \"20px\", lineHeight: \"16px\" }}\n          badgeContent=\"BETA\"\n          color=\"error\"\n          anchorOrigin={{ horizontal: \"right\", vertical: \"top\" }}\n          className={classes.betaBadge}\n        >\n          &nbsp;\n        </Badge>\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          value={prompt}\n          placeholder={strings.placeholder}\n          onChange={handlePromptChange}\n          onKeyUp={handleKeyUp}\n          InputProps={{\n            startAdornment: (\n              <InputAdornment position=\"start\">\n                <AssistantIcon color=\"primary\" fontSize=\"large\" />\n              </InputAdornment>\n            ),\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <Button onClick={handleSubmit}>{strings.button}</Button>\n              </InputAdornment>\n            )\n          }}\n          fullWidth={true}\n          variant=\"outlined\"\n        />\n        <Typography variant=\"caption\">Powered by ChatGPT API</Typography>\n      </DialogContent>\n      <DialogActions />\n    </>\n  );\n};\n\nconst ConfigureAIDialogContent: React.SFC<any> = (\n  props: AIPromptDialogProps & { configuration: AIConfiguration }\n) => {\n  const { onClose, classes } = props;\n\n  return (\n    <>\n      <DialogTitle style={{ paddingBottom: 0 }}>\n        AI Assistant\n        <Badge\n          style={{ marginLeft: \"20px\", lineHeight: \"16px\" }}\n          badgeContent=\"BETA\"\n          color=\"error\"\n          anchorOrigin={{ horizontal: \"right\", vertical: \"top\" }}\n          className={classes.betaBadge}\n        >\n          &nbsp;\n        </Badge>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant=\"body2\" className={classes.configureContent}>\n          Our AI assistant, powered by ChatGPT, is designed to simplify and\n          improve your content production and editing workflow. It offers a\n          user-friendly interface to help generate and edit content using\n          natural language.\n          <br />\n          <br />\n          Visit the link below to find out how to enable the AI assistant.\n        </Typography>\n        <AIPromptDialogGraphic className={classes.configureGraphic} />\n      </DialogContent>\n      <DialogActions>\n        <TextField\n          className={classes.getStartedAction}\n          value={\n            \"https://github.com/amplience/dc-extension-rich-text#ai-assistant\"\n          }\n        />\n        <Button className={classes.cancelAction} onClick={onClose}>\n          Not at the moment\n        </Button>\n      </DialogActions>\n    </>\n  );\n};\n\nconst AIPromptDialog: React.SFC<AIPromptDialogProps> = (\n  props: AIPromptDialogProps\n) => {\n  const { open, onClose, classes } = props;\n  const configuration = new AIConfiguration(props.params);\n  const view = configuration.getKey() ? \"prompt\" : \"configure\";\n\n  return (\n    <Dialog\n      maxWidth=\"sm\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n      className={clsx(\n        classes.root,\n        {\n          prompt: classes.prompt,\n          configure: classes.configure\n        }[view]\n      )}\n    >\n      {view === \"prompt\" && (\n        <AIPromptDialogContent {...props} configuration={configuration} />\n      )}\n      {view === \"configure\" && (\n        <ConfigureAIDialogContent\n          {...props}\n          configuration={configuration}\n          onClose={onClose}\n        />\n      )}\n    </Dialog>\n  );\n};\n\nexport default withStyles(styles)(AIPromptDialog);\n","import { datadogRum } from \"@datadog/browser-rum\";\nimport {\n  Alert,\n  RichTextActions,\n  RichTextEditorContextProps\n} from \"@dc-extension-rich-text/common\";\nimport { MarkdownLanguage } from \"@dc-extension-rich-text/language-markdown\";\nimport { Assistant as AssistantIcon } from \"@material-ui/icons\";\nimport { fetchEventSource } from \"@microsoft/fetch-event-source\";\nimport React from \"react\";\nimport { AIConfiguration } from \"../AIPromptDialog\";\n\ninterface ChatModel {\n  name: string;\n  version: string;\n  maxTokens: number;\n}\n\nconst CHAT_COMPLETIONS_URL = \"https://api.openai.com/v1/chat/completions\";\nconst CHAT_ESTIMATED_CHARS_PER_TOKEN = 4;\nconst CHAT_MODELS: ChatModel[] = [\n  {\n    name: \"gpt-3.5-turbo\",\n    version: \"gpt-3.5\",\n    maxTokens: 4096\n  },\n  {\n    name: \"gpt-3.5-turbo-16k\",\n    version: \"gpt-3.5\",\n    maxTokens: 16384\n  },\n  {\n    name: \"gpt-4\",\n    version: \"gpt-4\",\n    maxTokens: 8192\n  },\n  {\n    name: \"gpt-4-32k\",\n    version: \"gpt-4\",\n    maxTokens: 32768\n  }\n];\nconst DIALOG_PREFIX = \"[DIALOG]\";\n\nfunction getSuitableModel(\n  desiredModelName: string,\n  estimatedConsumedTokens: number\n): string {\n  const desiredModel = CHAT_MODELS.find(x => x.name === desiredModelName);\n\n  if (desiredModel && estimatedConsumedTokens > desiredModel.maxTokens) {\n    const rightSizeModel = CHAT_MODELS.find(\n      x =>\n        x.version === desiredModel.version &&\n        x.maxTokens > estimatedConsumedTokens\n    );\n    return rightSizeModel?.name || desiredModelName;\n  } else {\n    return desiredModelName;\n  }\n}\n\nasync function invokeChatCompletions(\n  configuration: AIConfiguration,\n  body: any,\n  onMessage: (buffer: string, complete: boolean) => void,\n  onError: (error: any) => void\n): Promise<void> {\n  const maxOutputTokens = 2048;\n  const estimatedInputTokens =\n    body.messages\n      .map((x: any) => x.content.length)\n      .reduce((partialSum: number, a: number) => partialSum + a, 0) /\n    CHAT_ESTIMATED_CHARS_PER_TOKEN;\n  const estimatedConsumedTokens = maxOutputTokens + estimatedInputTokens;\n  let markdownBuffer = \"\";\n  await fetchEventSource(CHAT_COMPLETIONS_URL, {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${configuration.getKey()}`\n    },\n    method: \"POST\",\n    body: JSON.stringify({\n      model: getSuitableModel(\n        configuration.getModel(),\n        estimatedConsumedTokens\n      ),\n      max_tokens: maxOutputTokens,\n      stream: true,\n      ...body\n    }),\n    onmessage: e => {\n      try {\n        if (e.data === \"[DONE]\") {\n          onMessage(markdownBuffer, true);\n          return;\n        }\n        const payload = JSON.parse(e.data);\n        const delta = payload.choices[0].delta.content;\n        if (delta !== undefined) {\n          markdownBuffer += delta;\n          onMessage(markdownBuffer, false);\n        }\n      } catch (err) {}\n    },\n    async onopen(response): Promise<void> {\n      const contentType = response.headers.get(\"content-type\");\n      if (contentType?.startsWith(\"application/json\")) {\n        onError(await response.json());\n        return;\n      }\n      if (\n        !(contentType === null || contentType.startsWith(\"text/event-stream\"))\n      ) {\n        throw new Error(\n          `Expected content-type to be 'text/event-stream', Actual: ${contentType}`\n        );\n      }\n    },\n    onerror(err): void {\n      throw err;\n    }\n  });\n}\n\nexport class RichTextActionsImpl implements RichTextActions {\n  private context: RichTextEditorContextProps | undefined;\n\n  public setRichTextEditorContext(context: RichTextEditorContextProps): void {\n    this.context = context;\n  }\n\n  public formatRewritePrompt(\n    body: string,\n    selection: string,\n    prompt: string\n  ): string {\n    return `This is the original content I am starting with: \n---\n${body}\n---\nThis is the selection I want to update:\n---\n${selection}\n---\nThis is the description of the change I want to make:\n---\n${prompt}`;\n  }\n\n  public async rewriteSelectedContentUsingAI(prompt: string): Promise<void> {\n    try {\n      datadogRum.addAction(\"rewriteSelectedContentUsingAI\", { prompt });\n    } catch (err) {}\n\n    const { proseMirrorEditorView, language } = this.context || {};\n\n    const { state } = proseMirrorEditorView;\n\n    const from = state.selection.from;\n    const to = state.selection.to;\n\n    const content = state.doc.cut(from, to);\n\n    const bodyMarkdown = (language as MarkdownLanguage).serializeMarkdown(\n      state.doc\n    );\n    const selectionMarkdown = (language as MarkdownLanguage).serializeMarkdown(\n      content\n    );\n\n    const sampleDocument = `# Say Cheese: The Ultimate Guide to Cheese\n\nCheese, the dairy product that has a special place in everyone's hearts, is a versatile ingredient that has been enjoyed for thousands of years across the globe. You can melt it, slice it, crumble it, or grate it - whatever way you choose, cheese always adds an extra dimension to any dish. In this ultimate guide to cheese, you'll learn everything you need to know about the world's favorite dairy product.\n\n## History of Cheese\n\nThe origin of cheese can be traced back to ancient times. Even before recorded history, it is believed that the process of cheesemaking was discovered accidentally by storing milk in animal bladders or stomachs, causing it to curdle and form cheese. Cheese quickly became a staple in the diets of people around the world and is now enjoyed in cultures all across the globe.\n\n## Types of Cheese\n\nThere are thousands of different types of cheese, each with its own flavor, texture, and aroma. From mild and creamy Brie to sharp and nutty Cheddar, there is a cheese for every taste preference. Some popular varieties of cheese include:\n\n* Cheddar\n\n* Brie\n\n* Mozzarella\n\n* Parmesan\n\n* Feta\n\n* Blue Cheese\n\n* Gouda\n\n## Conclusion\n\nCheese is a delicious and versatile ingredient that can be enjoyed in a variety of ways. From its humble beginnings thousands of years ago to its place as one of the world's most popular dairy products, cheese has a special place in the hearts of people around the world. So, let's raise a glass of wine and say cheese!`;\n\n    const sampleSelection = `You can melt it, slice it, crumble it, or grate it - whatever way you choose, cheese always adds an extra dimension to any dish.`;\n    const sampleResponse = `You can melt, slice, crumble, or grate it - cheese enhances any dish.`;\n\n    return this.handleInsertAIContent({\n      messages: [\n        {\n          role: \"system\",\n          content: `I want you to act as an editor for marketing copy.\n  - You will receive the original markdown document, followed by a selection from the document that the user wants to change, followed by a description of the change you should make.\n  - You should reply with a markdown formatted string that can replace the provided selection.\n\nDo not produce more content than you were originally provided unless specifically requested. \n  - If the selection includes only a header, reply with only a header. \n  - If the selection includes only a bullet point, reply with only a bullet point. \n  - If the selection includes only one line, reply with only one line. \n  - If the user asks you to make the selection longer, you can expand on the provided selection, but do not produce any additional elements.\n  - For example, if given a header, and asked to make it longer, you can add more text to the header, but you should not add any more lines.\n\nIf the user requests a change that you cannot produce a reasonable replacement for, you should respond with an error. \n  - Return errors sparingly, try to make a best effort attempt at handling the user's request whenever possible.\n  - If you return an error, prefix it with \\`[DIALOG]\\`. \n  - For example, if the user provides the selection \\`Banana\\` and asks you to shorten it, you might reply: \\`[DIALOG] I can't shorten \"Banana\" any further.\\`.\n\nDo not converse with the user. \n  - Do not ask clarifying questions. \n  - Do not add conversational preamble such as \\`Sure, I can do that\\`, or \\`Ok, here's the change\\`.`\n        },\n        {\n          role: \"user\",\n          content: this.formatRewritePrompt(\n            sampleDocument,\n            sampleSelection,\n            `Shorten this`\n          )\n        },\n        {\n          role: \"assistant\",\n          content: sampleResponse\n        },\n        {\n          role: \"user\",\n          content: this.formatRewritePrompt(\n            bodyMarkdown,\n            selectionMarkdown,\n            prompt\n          )\n        }\n      ]\n    });\n  }\n\n  public async insertAIContent(prompt: string): Promise<void> {\n    try {\n      datadogRum.addAction(\"insertAIContent\", { prompt });\n    } catch (err) {}\n\n    return this.handleInsertAIContent({\n      messages: [\n        {\n          role: \"system\",\n          content: `I want you to act as a copywriter that produces markdown formatted content for marketing.\n  - You will receive a prompt from the user.\n  - You should reply with a markdown document that can be used in marketing materials.\n  - Do not include hyperlinks in your response.\n  - Do not include images in your response.\n\nIf the user's prompt asks for only a portion of a document, you should return only that portion.\n  - If the user asks for only a title, produce only a title.\n  - If the user asks for only a paragraph, produce only a paragraph.\n  - If the user asks for only a bullet list, produce only a bullet list.\n\nIf the user provides a prompt that you cannot produce a document for, you should return an error.\n  - Prefix any errors with [DIALOG].\n  - For example, if the user's prompt is \\`Hello?\\`, then you might respond with \\`[DIALOG] Please describe the content you want to generate.\\`\n\nDo not converse with the user.\n  - Do not ask clarifying questions.\n  - Do not add conversational preamble such as \\`Sure, I can do that\\`, or \\`Ok, here's the change\\`.\n  - Do not include [DIALOG] if you've successfully produced a document.`\n        },\n        {\n          role: \"user\",\n          content: prompt\n        }\n      ]\n    });\n  }\n\n  public async handleInsertAIContent(payload: any): Promise<void> {\n    const {\n      proseMirrorEditorView,\n      setIsLocked,\n      params,\n      language\n    } = this.context!;\n    const configuration = new AIConfiguration(params);\n\n    const { dispatch } = proseMirrorEditorView;\n    let { state } = proseMirrorEditorView;\n\n    setIsLocked(true);\n\n    let startPosition = state.selection?.from ?? state.doc.content.size;\n    let endPosition = state.selection?.to || startPosition;\n\n    const resolved = state.doc.resolve(startPosition, endPosition);\n    const isEmptyParagraph =\n      resolved?.parent?.type?.name === \"paragraph\" &&\n      resolved?.parent?.content?.size === 0;\n\n    if (isEmptyParagraph) {\n      startPosition--;\n    }\n\n    let alert: Alert | undefined;\n\n    try {\n      await invokeChatCompletions(\n        configuration,\n        payload,\n        (buffer, complete) => {\n          const isEmpty = buffer.length === 0;\n          const isDialog = buffer.startsWith(DIALOG_PREFIX);\n          const couldBeDialog =\n            !complete &&\n            buffer.length < DIALOG_PREFIX.length &&\n            buffer === DIALOG_PREFIX.slice(0, buffer.length);\n\n          if (isDialog) {\n            const content = buffer.slice(DIALOG_PREFIX.length);\n            if (!alert) {\n              alert = this.context!.dialogs.alert({\n                title: \"AI Assistant\",\n                icon: <AssistantIcon />,\n                severity: \"info\",\n                content\n              });\n            } else {\n              alert.updateContent(content);\n            }\n            setIsLocked(false);\n            return;\n          }\n\n          if (isEmpty || couldBeDialog) {\n            return;\n          }\n\n          let fragment = (language as MarkdownLanguage).parseMarkdown(\n            buffer.trim()\n          ).content;\n\n          if (fragment.content.length === 1) {\n            fragment = fragment.content[0].content;\n          }\n\n          const transaction = state.tr.replaceWith(\n            startPosition,\n            endPosition,\n            fragment\n          );\n          const newState = dispatch(transaction);\n          state = newState;\n          endPosition = Math.max(\n            state.selection?.to,\n            startPosition + fragment.size\n          );\n        },\n        err => {\n          if (err?.error?.message) {\n            this.context!.dialogs.alert({\n              title: \"AI Assistant\",\n              icon: <AssistantIcon />,\n              severity: \"error\",\n              content: err?.error?.message\n            });\n          }\n        }\n      );\n    } catch {}\n\n    this.context?.setIsLocked(false);\n  }\n}\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Anchor } from \"@dc-extension-rich-text/common\";\n\ninterface AnchorDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Anchor) => void;\n  value: {\n    existing: Set<string>;\n    value: any;\n  };\n}\n\nconst htmlIdRegex = /^[a-zA-Z][\\w:.\\-]*$/;\n\nfunction validateId(value: string, existing: Set<string>): string | undefined {\n  if (value == null || value.length === 0) {\n    return \"ID cannot be empty.\";\n  }\n\n  if (!htmlIdRegex.test(value)) {\n    return \"Invalid ID.\";\n  }\n\n  if (existing.has(value)) {\n    return \"ID is already in use.\";\n  }\n\n  return undefined;\n}\n\nconst AnchorDialog: React.SFC<AnchorDialogProps> = (\n  props: AnchorDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n  const existing = props.value ? props.value.existing : new Set<string>();\n\n  const [value, setValue] = React.useState<Anchor>({\n    value: \"\"\n  });\n\n  const [lastValue, setLastValue] = React.useState<Anchor>();\n\n  if (\n    props.value != null &&\n    props.value.value != null &&\n    lastValue !== props.value.value\n  ) {\n    setValue(props.value.value);\n    setLastValue(props.value.value);\n  }\n\n  const validate = (checkValue: string) => validateId(checkValue, existing);\n\n  const valid = validate(value.value);\n  const [validError, setValidError] = React.useState<string | undefined>(valid);\n  if (valid !== validError) {\n    setValidError(valid);\n  }\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      const error = validate(newValue.value);\n      setValidError(error);\n    },\n    [value, setValue, setValidError]\n  );\n\n  const reset = () => {\n    setValue({\n      value: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Anchor</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            error={validError !== undefined}\n            autoFocus={true}\n            id=\"value\"\n            label=\"Anchor ID\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.value}\n            onChange={event => handleInputChanged(\"value\", event.target.value)}\n            helperText={validError}\n          />\n          <FormHelperText>Example: paragraph-4</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button\n          disabled={validError !== undefined}\n          onClick={handleSubmit}\n          color=\"primary\"\n        >\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default AnchorDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\ninterface CodeDialogProps {\n  value?: string;\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: string) => void;\n}\n\nconst htmlIdRegex = /^[a-zA-Z]?[\\w:.\\-\\/]*$/;\n\nconst validate = (checkValue: string) =>\n  !htmlIdRegex.test(checkValue) ? \"Value contains invalid characters\" : \"\";\n\nconst CodeDialog: React.SFC<CodeDialogProps> = (props: CodeDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<string>(\"\");\n\n  const [validError, setValidError] = React.useState<string>(\"\");\n\n  const [lastValue, setLastValue] = React.useState<string>();\n\n  if (lastValue !== props.value) {\n    setValue(props.value || \"\");\n    setLastValue(props.value);\n  }\n\n  const handleInputChanged = React.useCallback(\n    val => {\n      setValue(val || \"\");\n\n      const error = validate(val);\n      setValidError(error);\n    },\n    [value, setValue, setValidError]\n  );\n\n  const reset = () => {\n    setValue(\"\");\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Code block</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            error={!!validError}\n            helperText={validError}\n            autoFocus={true}\n            id=\"href\"\n            label=\"Language\"\n            type=\"input\"\n            fullWidth={true}\n            value={value}\n            onChange={event => handleInputChanged(event.target.value || \"\")}\n          />\n          <FormHelperText>\n            The language to use for syntax highlighting, e.g. javascript or html\n          </FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!!validError} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default CodeDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Hyperlink } from \"@dc-extension-rich-text/common\";\n\ninterface HyperlinkDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Hyperlink) => void;\n  value: any;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst HyperlinkDialog: React.SFC<HyperlinkDialogProps> = (\n  props: HyperlinkDialogProps\n) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Hyperlink>({\n    href: \"\",\n    title: \"\"\n  });\n\n  const [lastValue, setLastValue] = React.useState<Hyperlink>();\n\n  if (props.value != null && lastValue !== props.value) {\n    setValue(props.value);\n    setLastValue(props.value);\n  }\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.href));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      href: \"\",\n      title: \"\"\n    });\n    setLastValue(undefined);\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    if (lastValue === undefined) {\n      onClose();\n    } else {\n      onSubmit({ ...lastValue, cancel: true });\n    }\n  }, [lastValue, setLastValue, onSubmit]);\n\n  const handleClear = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={handleCancel}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Hyperlink</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"href\"\n            label=\"Web Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.href}\n            onChange={event => handleInputChanged(\"href\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://www.storefront.com/black-friday\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClear} color=\"primary\">\n          Clear\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default HyperlinkDialog;\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControl,\n  FormHelperText,\n  TextField\n} from \"@material-ui/core\";\nimport React from \"react\";\n\nimport { Image } from \"@dc-extension-rich-text/common\";\n\ninterface ImageDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSubmit: (value: Image) => void;\n}\n\nfunction validateUrl(value: string): boolean {\n  return value != null && value.length > 0;\n}\n\nconst ImageDialog: React.SFC<ImageDialogProps> = (props: ImageDialogProps) => {\n  const { open, onClose, onSubmit } = props;\n\n  const [value, setValue] = React.useState<Image>({\n    src: \"\",\n    alt: \"\",\n    title: \"\"\n  });\n\n  const [isValid, setIsValid] = React.useState(false);\n\n  const handleInputChanged = React.useCallback(\n    (name: string, fieldValue: string) => {\n      const newValue = {\n        ...value,\n        [name]: fieldValue\n      };\n\n      setValue(newValue);\n      setIsValid(validateUrl(newValue.src));\n    },\n    [value, setValue, setIsValid]\n  );\n\n  const reset = () => {\n    setValue({\n      src: \"\",\n      alt: \"\",\n      title: \"\"\n    });\n  };\n\n  const handleCancel = React.useCallback(() => {\n    reset();\n    onClose();\n  }, [setValue, onClose]);\n\n  const handleSubmit = React.useCallback(() => {\n    reset();\n    onSubmit(value);\n  }, [value, setValue, onSubmit]);\n\n  return (\n    <Dialog\n      maxWidth=\"md\"\n      fullWidth={true}\n      open={open}\n      onClose={onClose}\n      aria-labelledby=\"form-dialog-title\"\n    >\n      <DialogTitle id=\"form-dialog-title\">Insert Image from URL</DialogTitle>\n      <DialogContent>\n        <FormControl fullWidth={true}>\n          <TextField\n            autoFocus={true}\n            id=\"src\"\n            label=\"Image Address\"\n            type=\"input\"\n            required={true}\n            fullWidth={true}\n            value={value.src}\n            onChange={event => handleInputChanged(\"src\", event.target.value)}\n          />\n          <FormHelperText>\n            Example: https://cdn.storefront.com/image.jpg\n          </FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"title\"\n            label=\"Image Title\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.title}\n            onChange={event => handleInputChanged(\"title\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n\n        <FormControl fullWidth={true}>\n          <TextField\n            id=\"alt\"\n            label=\"Image Alternative Text\"\n            type=\"input\"\n            fullWidth={true}\n            value={value.alt}\n            onChange={event => handleInputChanged(\"alt\", event.target.value)}\n          />\n          <FormHelperText>Example: Black Friday Sale</FormHelperText>\n        </FormControl>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleCancel} color=\"primary\">\n          Cancel\n        </Button>\n        <Button disabled={!isValid} onClick={handleSubmit} color=\"primary\">\n          Insert\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ImageDialog;\n","import { RichTextDialogs } from \"@dc-extension-rich-text/common\";\nimport React from \"react\";\n\nexport interface RichTextDialogsContext {\n  dialogs?: RichTextDialogs;\n}\n\nconst context = React.createContext<RichTextDialogsContext>({});\nexport default context;\n","import { AlertSeverity } from \"@dc-extension-rich-text/common\";\nimport {\n  darken,\n  IconButton,\n  lighten,\n  Theme,\n  Typography,\n  WithStyles,\n  withStyles\n} from \"@material-ui/core\";\nimport { Close as CloseIcon } from \"@material-ui/icons\";\nimport clsx from \"clsx\";\nimport React, { PropsWithChildren } from \"react\";\n\nconst styles = (theme: Theme) => ({\n  root: {\n    ...theme.typography.body2,\n    display: \"flex\",\n    flexDirection: \"row\" as \"row\",\n    maxWidth: 300,\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: \"transparent\",\n    padding: \"6px 16px\"\n  },\n\n  success: {\n    color: darken(theme.palette.success.main, 0.6),\n    backgroundColor: lighten(theme.palette.success.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.success.main\n    }\n  },\n\n  info: {\n    color: darken(theme.palette.info.main, 0.6),\n    backgroundColor: lighten(theme.palette.info.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.info.main\n    }\n  },\n\n  warning: {\n    color: darken(theme.palette.warning.main, 0.6),\n    backgroundColor: lighten(theme.palette.warning.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.warning.main\n    }\n  },\n\n  error: {\n    color: darken(theme.palette.error.main, 0.6),\n    backgroundColor: lighten(theme.palette.error.main, 0.9),\n    \"& $icon\": {\n      color: theme.palette.error.main\n    }\n  },\n\n  title: {\n    fontWeight: theme.typography.fontWeightMedium\n  },\n\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\" as \"row\"\n  },\n\n  content: {\n    padding: \"8px 0\"\n  },\n\n  icon: {\n    marginRight: 12,\n    padding: \"7px 0\",\n    display: \"flex\",\n    fontSize: 22,\n    opacity: 0.9\n  },\n\n  action: {\n    display: \"flex\",\n    alignItems: \"center\",\n    marginLeft: \"auto\",\n    paddingLeft: 16,\n    marginRight: -8\n  }\n});\n\nexport interface RichTextAlertProps\n  extends PropsWithChildren<WithStyles<typeof styles>> {\n  severity: AlertSeverity;\n  title: string;\n  icon?: React.ReactElement;\n  onClose?: () => void;\n}\n\nconst RichTextAlert = (props: RichTextAlertProps) => {\n  const { classes, children, severity, title, icon, onClose } = props;\n\n  return (\n    <div\n      className={clsx(\n        classes.root,\n        {\n          info: classes.info,\n          success: classes.success,\n          error: classes.error,\n          warning: classes.warning\n        }[severity]\n      )}\n    >\n      <div className={classes.icon}>{icon}</div>\n      <div className={classes.content}>\n        <div className={classes.header}>\n          <Typography variant=\"body1\" className={classes.title}>\n            {title}\n          </Typography>\n        </div>\n        {children}\n      </div>\n      <div className={classes.action}>\n        <IconButton onClick={onClose} size=\"small\" color=\"inherit\">\n          <CloseIcon />\n        </IconButton>\n      </div>\n    </div>\n  );\n};\n\nexport default withStyles(styles)(RichTextAlert);\n","import React, { PropsWithChildren } from \"react\";\n\nimport {\n  AIPromptDialogOptions,\n  Alert,\n  AlertOptions,\n  Anchor,\n  Hyperlink,\n  Image,\n  RichTextDialogs\n} from \"@dc-extension-rich-text/common\";\n\nimport { ContentItemLink, MediaImageLink } from \"dc-extensions-sdk\";\nimport AnchorDialog from \"../AnchorDialog/AnchorDialog\";\nimport CodeDialog from \"../CodeDialog/CodeDialog\";\nimport HyperlinkDialog from \"../HyperlinkDialog/HyperlinkDialog\";\nimport ImageDialog from \"../ImageDialog/ImageDialog\";\nimport RichTextDialogsContext from \"./RichTextDialogsContext\";\n\nimport { Snackbar, Typography } from \"@material-ui/core\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\nimport { AIPromptDialog } from \"../AIPromptDialog\";\nimport RichTextAlert from \"./RichTextAlert\";\n\ninterface EditorDialogsProps extends PropsWithChildren<{}> {\n  params?: any;\n}\n\ninterface OpenDialog {\n  type: string;\n  resolve: (value: any) => void;\n  reject: () => void;\n  value: any;\n  options?: any;\n}\n\nlet alertId = 0;\n\nconst RichTextDialogsContainer: React.SFC<EditorDialogsProps> = (\n  props: EditorDialogsProps\n) => {\n  const { children, params } = props;\n\n  const [openDialog, setOpenDialog] = React.useState<OpenDialog>();\n  const [alerts, dispatchAlertEvent] = React.useReducer(\n    (state: Alert[], action: any) => {\n      switch (action.type) {\n        case \"ADD_ALERT\":\n          return [...state, action.alert];\n        case \"REMOVE_ALERT\":\n          const alertIndex = state.findIndex(x => x.id === action.id);\n          if (alertIndex !== -1) {\n            state.splice(alertIndex, 1);\n          }\n          return [...state];\n        case \"UPDATE_ALERT_CONTENT\":\n          const alert = state.find(x => x.id === action.id);\n          if (alert) {\n            alert.content = action.content;\n          }\n          return [...state];\n      }\n      return state;\n    },\n    []\n  );\n\n  const handleCloseDialog = React.useCallback(() => {\n    if (openDialog) {\n      openDialog.reject();\n    }\n    setOpenDialog(undefined);\n  }, [openDialog, setOpenDialog]);\n\n  const handleSubmitDialog = React.useCallback(\n    (value: any) => {\n      if (openDialog) {\n        openDialog.resolve(value);\n      }\n      setOpenDialog(undefined);\n    },\n    [openDialog, setOpenDialog]\n  );\n\n  const handleOpenDialog = React.useCallback(\n    (type: string, value?: any, options?: any) => {\n      return new Promise((resolve, reject) => {\n        setOpenDialog({\n          type,\n          resolve,\n          reject,\n          value,\n          options\n        });\n      });\n    },\n    [setOpenDialog]\n  );\n\n  const { sdk } = React.useContext(SdkContext);\n\n  const handleUpdateAlertContent = React.useCallback(\n    (id, content) => {\n      dispatchAlertEvent({\n        type: \"UPDATE_ALERT_CONTENT\",\n        id,\n        content\n      });\n    },\n    [dispatchAlertEvent]\n  );\n\n  const handleCloseAlert = React.useCallback(\n    id => {\n      dispatchAlertEvent({\n        type: \"REMOVE_ALERT\",\n        id\n      });\n    },\n    [dispatchAlertEvent]\n  );\n\n  const dialogs: RichTextDialogs = {\n    getAnchor: (existing: Set<string>, value?: Anchor): Promise<Anchor> => {\n      return handleOpenDialog(\"anchor\", { value, existing }) as Promise<Anchor>;\n    },\n    getCode: (value?: string): Promise<string> => {\n      return handleOpenDialog(\"code\", value) as Promise<string>;\n    },\n    getHyperlink: (value?: Hyperlink): Promise<Hyperlink> => {\n      return handleOpenDialog(\"hyperlink\", value) as Promise<Hyperlink>;\n    },\n    getImage: (value?: Image): Promise<Image> => {\n      return handleOpenDialog(\"image\") as Promise<Image>;\n    },\n    getDcImageLink: (value?: MediaImageLink): Promise<MediaImageLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.mediaLink.getImage();\n      }\n    },\n    getDcContentLink: (\n      contentTypeIds: string[],\n      value?: ContentItemLink\n    ): Promise<ContentItemLink> => {\n      if (!sdk) {\n        return Promise.reject();\n      } else {\n        return sdk.contentLink.get(contentTypeIds);\n      }\n    },\n    getAIPrompt(dialogProps: AIPromptDialogOptions): Promise<string> {\n      return handleOpenDialog(\"ai_prompt\", undefined, dialogProps) as Promise<\n        string\n      >;\n    },\n    alert(alertProps: AlertOptions): Alert {\n      const alert: any = {\n        id: `${alertId++}`,\n        ...alertProps\n      };\n      alert.updateContent = (content: string | React.ReactElement) => {\n        handleUpdateAlertContent(alert.id, content);\n      };\n      dispatchAlertEvent({\n        type: \"ADD_ALERT\",\n        alert\n      });\n      return alert;\n    }\n  };\n\n  return (\n    <RichTextDialogsContext.Provider value={{ dialogs }}>\n      {children}\n\n      <AnchorDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"anchor\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <CodeDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"code\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <HyperlinkDialog\n        value={openDialog != null ? openDialog.value : undefined}\n        open={openDialog != null && openDialog.type === \"hyperlink\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n      <ImageDialog\n        open={openDialog != null && openDialog.type === \"image\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n      />\n\n      <AIPromptDialog\n        open={openDialog != null && openDialog.type === \"ai_prompt\"}\n        onClose={handleCloseDialog}\n        onSubmit={handleSubmitDialog}\n        params={params}\n        {...(openDialog?.options || {})}\n      />\n\n      {alerts.map((alert: Alert) => (\n        <Snackbar\n          key={alert.id}\n          onClose={() => handleCloseAlert(alert.id)}\n          open={true}\n          autoHideDuration={6000}\n          anchorOrigin={{ vertical: \"bottom\", horizontal: \"right\" }}\n        >\n          <RichTextAlert\n            severity={alert.severity}\n            title={alert.title}\n            icon={alert.icon}\n            onClose={() => handleCloseAlert(alert.id)}\n          >\n            {alert.content}\n          </RichTextAlert>\n        </Snackbar>\n      ))}\n    </RichTextDialogsContext.Provider>\n  );\n};\n\nexport default RichTextDialogsContainer;\n","import React from \"react\";\n\nimport { Chip, Grid, Theme, WithStyles, withStyles } from \"@material-ui/core\";\n\nimport { isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport { Assistant as AssistantIcon } from \"@material-ui/icons\";\nimport { AIConfiguration } from \"../AIPromptDialog\";\nimport { useRichTextEditorContext } from \"../RichTextEditor/RichTextEditorContext\";\n\nconst styles = (theme: Theme) => ({\n  root: {\n    borderTop: \"1px solid rgb(218, 220, 224)\",\n    position: \"absolute\" as \"absolute\",\n    background: \"white\",\n    paddingTop: \"10px\",\n    width: \"100%\",\n    bottom: 0\n  },\n  chip: {\n    background: theme.palette.background.paper,\n    \"& .MuiChip-icon\": {\n      color: theme.palette.primary.main\n    }\n  }\n});\n\nexport interface RichTextEditorAIActionsBarProps\n  extends WithStyles<typeof styles> {}\n\nconst RichTextEditorAIActionsBar: React.SFC<RichTextEditorAIActionsBarProps> = (\n  props: RichTextEditorAIActionsBarProps\n) => {\n  const { classes } = props;\n  const {\n    params,\n    actions,\n    dialogs,\n    proseMirrorEditorView\n  } = useRichTextEditorContext();\n\n  const configuration = new AIConfiguration(params);\n  const isAiToolEnabled = isToolEnabled(\"ai\", params);\n  const hasKey = Boolean(configuration.getKey());\n  const editPrompts = configuration.getEditPrompts();\n\n  const handleEditPrompt = async (prompt: any) => {\n    await actions.rewriteSelectedContentUsingAI(prompt.prompt);\n  };\n\n  const handleCustomAiRewrite = async () => {\n    const prompt = await dialogs.getAIPrompt({ variant: \"rewrite\" });\n    await actions.rewriteSelectedContentUsingAI(prompt);\n  };\n\n  return isAiToolEnabled && hasKey ? (\n    <div\n      className={classes.root}\n      style={{\n        display: proseMirrorEditorView?.state.selection.empty ? \"none\" : \"block\"\n      }}\n    >\n      <Grid direction=\"row\" spacing={1} container={true}>\n        {editPrompts.map((prompt: any) => {\n          return (\n            <Grid key={prompt.label} item={true}>\n              <Chip\n                className={classes.chip}\n                icon={<AssistantIcon color=\"primary\" />}\n                label={prompt.label}\n                variant=\"outlined\"\n                onClick={() => handleEditPrompt(prompt)}\n              />\n            </Grid>\n          );\n        })}\n        <Grid item={true}>\n          <Chip\n            className={classes.chip}\n            icon={<AssistantIcon color=\"primary\" />}\n            label=\"Custom...\"\n            variant=\"outlined\"\n            onClick={() => handleCustomAiRewrite()}\n          />\n        </Grid>\n      </Grid>\n    </div>\n  ) : (\n    <></>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditorAIActionsBar);\n","import { WithStyles, withStyles } from \"@material-ui/core\";\nimport React, { ChangeEvent, useReducer, useState } from \"react\";\nimport CodeTextArea from \"../CodeTextArea/CodeTextArea\";\nimport ProseMirror from \"../ProseMirror/ProseMirror\";\nimport { EditorView, ViewSwitcher } from \"../ViewSwitcher\";\n\nimport {\n  RichLanguageFormat,\n  RichTextEditorContextProps,\n  RichTextLanguageMap\n} from \"@dc-extension-rich-text/common\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport ProseMirrorToolbar, {\n  ToolbarElement\n} from \"../ProseMirrorToolbar/ProseMirrorToolbar\";\nimport DefaultToolbar from \"./DefaultToolbar\";\n\nimport {\n  computeToolbarState,\n  ProseMirrorToolbarState\n} from \"../ProseMirrorToolbar/ProseMirrorToolbarState\";\nimport { RichTextActionsImpl } from \"../RichTextActions\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\nimport RichTextEditorAIActionsBar from \"../RichTextEditorAIActionsBar/RichTextEditorAIActionsBar\";\nimport RichtextEditorContext from \"./RichTextEditorContext\";\n\nconst styles = {\n  root: {\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\"\n  },\n  frame: {\n    flex: 1,\n    display: \"flex\",\n    flexDirection: \"column\" as \"column\",\n    border: \"1px solid rgba(157,162,162,.3)\",\n    borderRadius: 5,\n    padding: \"0 10px 10px 10px\"\n  }\n};\n\nexport interface RichTextEditorProps extends WithStyles<typeof styles> {\n  languages?: RichTextLanguageMap;\n  language?: string;\n  disableToolbar?: boolean;\n  toolbarLayout?: ToolbarElement[];\n  disableCodeView?: boolean;\n  readOnlyCodeView?: boolean;\n  editorViewOptions?: any;\n  value?: any;\n  onChange?: (value: any) => void;\n  params?: any;\n}\n\nconst RichTextEditor: React.SFC<RichTextEditorProps> = (\n  props: RichTextEditorProps\n) => {\n  const {\n    classes,\n    languages: languagesProp,\n    language: languageProp = \"markdown\",\n    toolbarLayout: toolbarLayoutProp,\n    disableToolbar = false,\n    disableCodeView = false,\n    readOnlyCodeView = false,\n    editorViewOptions,\n    value: valueProp,\n    onChange,\n    params\n  } = props;\n\n  const [isLocked, setIsLocked] = useState(false);\n  const [proseMirrorEditorView, setProseMirrorEditorView] = useState<\n    any | undefined\n  >(undefined);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n  const [actions] = useState(new RichTextActionsImpl());\n\n  const languages: RichTextLanguageMap = languagesProp || {\n    markdown: MarkdownLanguage({})\n  };\n\n  if (!languages[languageProp]) {\n    throw new Error(`Unable to find language ${props.language}`);\n  }\n\n  const { language, conf: languageConfiguration } = languages[languageProp];\n\n  const editorContext: RichTextEditorContextProps = {\n    isLocked,\n    setIsLocked,\n    proseMirrorEditorView,\n    dialogs: dialogs!,\n    actions,\n    params,\n    languages,\n    language\n  };\n\n  actions.setRichTextEditorContext(editorContext);\n\n  const [view, setView] = React.useState(EditorView.EDIT);\n  const [rawValue, setRawValue] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    if (languageConfiguration.format === RichLanguageFormat.JSON) {\n      return JSON.stringify(valueProp, null, 3);\n    } else {\n      return valueProp;\n    }\n  });\n  const [proseMirrorDocument, setProseMirrorDocument] = React.useState(() => {\n    if (!valueProp) {\n      return undefined;\n    }\n\n    try {\n      return language.parse(valueProp);\n      // tslint:disable-next-line\n    } catch (err) {}\n  });\n\n  const handleRawValueChange = React.useCallback(\n    (value: any) => {\n      setRawValue(value);\n\n      if (languageConfiguration.format === RichLanguageFormat.JSON) {\n        try {\n          value = JSON.parse(value);\n        } catch (err) {\n          return;\n        }\n      }\n\n      if (onChange) {\n        onChange(value);\n      }\n\n      try {\n        const newProseMirrorDocument = language.parse(value);\n        setProseMirrorDocument(newProseMirrorDocument);\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setRawValue, setProseMirrorDocument, onChange]\n  );\n\n  const handleEditorChange = React.useCallback(\n    (doc: any) => {\n      setProseMirrorDocument(doc);\n      try {\n        const newRawValue = language.serialize(doc);\n\n        if (languageConfiguration.format === RichLanguageFormat.JSON) {\n          setRawValue(JSON.stringify(newRawValue, null, 3));\n        } else {\n          setRawValue(newRawValue);\n        }\n\n        if (onChange) {\n          onChange(newRawValue);\n        }\n        // tslint:disable-next-line\n      } catch (err) {}\n    },\n    [languageConfiguration, setProseMirrorDocument, setRawValue]\n  );\n\n  const [toolbarState, setToolbarState] = React.useState<\n    ProseMirrorToolbarState\n  >();\n  const toolbarLayout = toolbarLayoutProp || DefaultToolbar;\n\n  const handleEditorUpdateState = React.useCallback(\n    (state: any, editorView: any) => {\n      setProseMirrorEditorView(editorView);\n      setToolbarState(\n        computeToolbarState(language.tools, state, editorContext)\n      );\n    },\n    [language, setToolbarState]\n  );\n\n  return (\n    <RichtextEditorContext.Provider value={editorContext}>\n      <div className={classes.root}>\n        <div className={classes.frame}>\n          <ViewSwitcher\n            onChange={setView}\n            language={language.label}\n            disableCodeView={disableCodeView}\n          />\n          {view === EditorView.EDIT ? (\n            <div>\n              {disableToolbar ? (\n                false\n              ) : (\n                <ProseMirrorToolbar\n                  toolbarState={toolbarState}\n                  layout={toolbarLayout}\n                  isLocked={editorContext.isLocked}\n                />\n              )}\n              <div style={{ position: \"relative\" }}>\n                <ProseMirror\n                  editorViewOptions={editorViewOptions}\n                  schema={language.schema}\n                  onChange={handleEditorChange}\n                  onUpdateState={handleEditorUpdateState}\n                  doc={proseMirrorDocument}\n                  isLocked={editorContext.isLocked}\n                />\n                <RichTextEditorAIActionsBar />\n              </div>\n            </div>\n          ) : (\n            <CodeTextArea\n              value={rawValue}\n              onChange={handleRawValueChange}\n              readOnly={editorContext.isLocked || readOnlyCodeView}\n            />\n          )}\n        </div>\n      </div>\n    </RichtextEditorContext.Provider>\n  );\n};\n\nexport default withStyles(styles)(RichTextEditor);\n","import {\n  ProseMirrorTool,\n  ProseMirrorToolState,\n  RichTextEditorContextProps\n} from \"@dc-extension-rich-text/common\";\n\nexport interface ProseMirrorToolbarState {\n  tools: ProseMirrorTool[];\n  toolStates: { [toolName: string]: ProseMirrorToolState };\n}\n\nexport function computeToolbarState(\n  tools: ProseMirrorTool[],\n  editorState: any,\n  richTextEditorContext: RichTextEditorContextProps\n): ProseMirrorToolbarState {\n  const toolStates: { [toolName: string]: ProseMirrorToolState } = {};\n\n  for (const tool of tools) {\n    const state = {\n      active: false,\n      enabled: true,\n      visible: true,\n      ...tool\n    };\n\n    if (tool.isActive) {\n      state.active = tool.isActive(editorState, richTextEditorContext);\n    }\n\n    if (tool.isVisible) {\n      state.visible = tool.isVisible(editorState, richTextEditorContext);\n    }\n\n    if (tool.isEnabled) {\n      state.enabled = tool.isEnabled(editorState, richTextEditorContext);\n    }\n\n    toolStates[tool.name] = state;\n  }\n\n  return {\n    tools,\n    toolStates\n  };\n}\n","import React from \"react\";\n\nimport { withStyles, WithStyles } from \"@material-ui/core\";\n\nimport { ToolbarElement } from \"../ProseMirrorToolbar\";\nimport { RichTextEditor } from \"../RichTextEditor\";\n\nimport JSONLanguage from \"@dc-extension-rich-text/language-json\";\nimport MarkdownLanguage from \"@dc-extension-rich-text/language-markdown\";\nimport { SdkContext } from \"unofficial-dynamic-content-ui\";\n\nimport {\n  RichLanguage,\n  RichLanguageConfiguration\n} from \"@dc-extension-rich-text/common\";\nimport {\n  ContentTypeExtensionSettings,\n  DcContentLinkView,\n  DcImageLinkView,\n  DynamicContentToolOptions,\n  OldContentTypeExtensionSettings\n} from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport { RichTextActionsImpl } from \"../RichTextActions\";\nimport { RichTextDialogsContext } from \"../RichTextDialogs\";\n\nexport const styles = {\n  root: {\n    width: \"100%\"\n  },\n  title: {\n    padding: \"7px 0\",\n    minHeight: \"20px\",\n    color: \"#666\",\n    fontSize: \"13px\",\n    boxSizing: \"border-box\" as \"border-box\",\n    \"-webkit-font-smoothing\": \"auto\",\n    fontFamily: \"roboto,sans-serif!important\"\n  }\n};\n\nexport interface EditorRichTextFieldProps extends WithStyles<typeof styles> {\n  schema: any;\n  value?: any;\n  onChange?: (value: any) => void;\n}\n\nexport interface EditorRichTextFieldParams {\n  title?: string;\n  language?: string;\n\n  styles?: string;\n  stylesheet?: string;\n\n  useClasses?: boolean;\n  classOverride?: { [originalName: string]: string };\n\n  codeView?: {\n    readOnly?: boolean;\n    disabled?: boolean;\n  };\n\n  editView?: {};\n\n  toolbar?: {\n    layout?: ToolbarElement[];\n    disabled?: boolean;\n  };\n\n  tools?: {\n    whitelist?: string[];\n    blacklist?: string[];\n\n    \"dc-content-link\"?: {\n      contentTypes?: string[];\n      contentTypeSettings?:\n        | ContentTypeExtensionSettings[]\n        | OldContentTypeExtensionSettings;\n    };\n  };\n}\n\nconst EditorRichTextField: React.SFC<EditorRichTextFieldProps> = (\n  props: EditorRichTextFieldProps\n) => {\n  const { schema, value: valueProp, onChange, classes } = props;\n\n  let params: EditorRichTextFieldParams =\n    schema?.[\"ui:extension\"]?.params || {};\n\n  const { sdk } = React.useContext(SdkContext);\n  const { dialogs } = React.useContext(RichTextDialogsContext);\n\n  params = sdk\n    ? { ...params, ...sdk.params?.installation, ...sdk.params?.instance }\n    : params;\n\n  const toolOptions = React.useMemo<DynamicContentToolOptions>(() => {\n    const settings = {\n      useClasses: params.useClasses,\n      classOverride: params.classOverride,\n      dialogs,\n      actions: new RichTextActionsImpl(),\n      dynamicContent: {\n        stagingEnvironment: sdk ? sdk.stagingEnvironment : undefined\n      },\n      tools: params.tools\n    };\n\n    if (settings.tools && !settings.tools.blacklist) {\n      // disable inline_styles by default\n      settings.tools.blacklist = [\"inline_styles\"];\n    }\n\n    return settings;\n  }, [sdk, dialogs, params]);\n\n  const languages = React.useMemo<{\n    [name: string]: { language: RichLanguage; conf: RichLanguageConfiguration };\n  }>(() => {\n    return {\n      markdown: MarkdownLanguage(toolOptions),\n      json: JSONLanguage(toolOptions)\n    };\n  }, []);\n\n  const language = params.language || \"markdown\";\n\n  const editorViewOptions = React.useMemo(() => {\n    return {\n      nodeViews: {\n        \"dc-image-link\": (node: any, view: any, getPos: any) =>\n          new DcImageLinkView(node, view, getPos, toolOptions),\n        \"dc-content-link\": (node: any, view: any, getPos: any) =>\n          new DcContentLinkView(node, view, getPos, toolOptions)\n      }\n    };\n  }, [sdk, toolOptions]);\n\n  return (\n    <div className={classes.root}>\n      {params.styles ? (\n        <style dangerouslySetInnerHTML={{ __html: params.styles }} />\n      ) : (\n        false\n      )}\n      {params.stylesheet ? (\n        <link rel=\"stylesheet\" href={params.stylesheet} />\n      ) : (\n        false\n      )}\n\n      {params.title ? (\n        <div className={classes.title}>{params.title}</div>\n      ) : (\n        false\n      )}\n\n      <RichTextEditor\n        languages={languages}\n        language={params.language}\n        editorViewOptions={editorViewOptions}\n        toolbarLayout={params.toolbar ? params.toolbar.layout : undefined}\n        disableToolbar={params.toolbar ? params.toolbar.disabled : undefined}\n        disableCodeView={params.codeView ? params.codeView.disabled : undefined}\n        readOnlyCodeView={\n          params.codeView ? params.codeView.readOnly : undefined\n        }\n        onChange={onChange}\n        params={params}\n        value={valueProp}\n      />\n    </div>\n  );\n};\n\nexport default withStyles(styles)(EditorRichTextField);\n","import React from \"react\";\n\nimport { datadogRum } from \"@datadog/browser-rum\";\nimport { init, SDK } from \"dc-extensions-sdk\";\nimport { SdkContext, withTheme } from \"unofficial-dynamic-content-ui\";\nimport EditorRichTextField from \"./EditorRichTextField/EditorRichTextField\";\nimport { RichTextDialogsContainer } from \"./RichTextDialogs\";\n\ninterface AppState {\n  connected: boolean;\n  sdk?: SDK;\n  value?: string;\n  params?: any;\n}\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: {}) {\n    super(props);\n    this.state = { connected: false };\n    this.handleValueChange = this.handleValueChange.bind(this);\n    this.handleChooseLink = this.handleChooseLink.bind(this);\n  }\n\n  public componentDidMount(): void {\n    this.handleConnect();\n    this.handleInitRum();\n  }\n\n  public handleInitRum(): void {\n    const ddToken = process.env.REACT_APP_DATADOG_TOKEN;\n    const ddAppId = process.env.REACT_APP_DATADOG_APP_ID;\n    const ddEnv = process.env.REACT_APP_DATADOG_ENV_ID;\n\n    if (ddToken && ddAppId && ddEnv) {\n      datadogRum.init({\n        applicationId: ddAppId,\n        clientToken: ddToken,\n        env: ddEnv,\n        site: \"datadoghq.com\",\n        service: \"dc-extension-rich-text\",\n        version: \"0.1.0\",\n        trackResources: true,\n        trackLongTasks: true,\n        trackUserInteractions: true,\n        defaultPrivacyLevel: \"allow\",\n        sampleRate: 100,\n        useCrossSiteSessionCookie: true\n      });\n\n      datadogRum.startSessionReplayRecording();\n    }\n  }\n\n  public async handleConnect(): Promise<void> {\n    const sdk: SDK = await init();\n    sdk.frame.startAutoResizer();\n\n    sdk.contentItem.getCurrent().then(item => {\n      datadogRum.setGlobalContext({\n        deliveryId: item.deliveryId\n      });\n    });\n\n    const params = {\n      ...sdk.field?.schema?.[\"ui:extension\"]?.params,\n      ...sdk.params?.installation,\n      ...sdk.params?.instance\n    };\n\n    const value: any = await sdk.field.getValue();\n    this.setState({\n      sdk,\n      connected: true,\n      value,\n      params\n    });\n  }\n\n  public handleValueChange(value: any): void {\n    if (this.state.connected && this.state.sdk) {\n      this.state.sdk.field.setValue(value);\n    }\n  }\n\n  public async handleChooseLink(): Promise<{ href: string; title: string }> {\n    return { href: \"\", title: \"\" };\n  }\n\n  public render(): React.ReactElement {\n    const { connected, value, sdk } = this.state;\n\n    return (\n      <div className=\"App\">\n        {connected && sdk ? (\n          <div>\n            {withTheme(\n              <SdkContext.Provider value={{ sdk }}>\n                <RichTextDialogsContainer params={this.state.params}>\n                  <EditorRichTextField\n                    onChange={this.handleValueChange}\n                    value={value}\n                    schema={sdk.field.schema}\n                  />\n                </RichTextDialogsContainer>\n              </SdkContext.Provider>\n            )}\n          </div>\n        ) : (\n          <div>&nbsp;</div>\n        )}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"typeface-roboto\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","export function isToolEnabled(toolName, options) {\n    if (options.tools &&\n        options.tools.blacklist &&\n        options.tools.blacklist.indexOf(toolName) !== -1) {\n        return false;\n    }\n    if (options.tools &&\n        options.tools.whitelist &&\n        options.tools.whitelist.indexOf(toolName) === -1) {\n        return false;\n    }\n    return true;\n}\nvar classNameRegex = /^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$/;\nexport function getCustomClass(defaultName, options) {\n    if (options && options.classOverride) {\n        var name_1 = options.classOverride[defaultName];\n        return name_1 && classNameRegex.test(name_1) ? name_1 : defaultName;\n    }\n    return defaultName;\n}\nexport function getDefaultClass(customName, options) {\n    if (options && options.classOverride) {\n        var classes_1 = options.classOverride;\n        var keys = Object.keys(classes_1);\n        return keys.find(function (key) { return classes_1[key] === customName; }) || customName;\n    }\n    return customName;\n}\n","export function inBlock(state) {\n    var $from = state.selection.$from;\n    return $from.depth > 1;\n}\nexport function isMarkActive(state, type) {\n    var _a = state.selection, from = _a.from, $from = _a.$from, to = _a.to, empty = _a.empty;\n    if (empty) {\n        return type.isInSet(state.storedMarks || $from.marks());\n    }\n    else {\n        return state.doc.rangeHasMark(from, to, type);\n    }\n}\nexport function getSelectionMarks(state) {\n    var _a = state.selection, $from = _a.$from, $to = _a.$to;\n    var currentMarks = [];\n    state.doc.nodesBetween($from.pos, $to.pos, function (node, start) {\n        node.marks.forEach(function (mark) {\n            return currentMarks.push({ from: start, to: start + node.nodeSize, mark: mark });\n        });\n    });\n    return currentMarks;\n}\nexport function hasMarkup(state, type, atts) {\n    var _a = state.selection, $from = _a.$from, to = _a.to, node = _a.node;\n    if (node) {\n        return node.hasMarkup(type, atts);\n    }\n    return to <= $from.end() && $from.parent.hasMarkup(type, atts);\n}\nexport function canInsert(state, type) {\n    var $from = state.selection.$from;\n    for (var d = $from.depth; d >= 0; d--) {\n        var index = $from.index(d);\n        if ($from.node(d).canReplaceWith(index, index, type)) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function clearAllMarks() {\n    return function (state, dispatch) {\n        var ref = state.selection;\n        var $cursor = ref.$cursor;\n        var ranges = ref.ranges;\n        if (dispatch) {\n            if ($cursor) {\n                var marks = state.storedMarks || $cursor.marks();\n                for (var _i = 0, marks_1 = marks; _i < marks_1.length; _i++) {\n                    var mark = marks_1[_i];\n                    dispatch(state.tr.removeStoredMark(mark.type));\n                }\n            }\n            else {\n                var tr = state.tr;\n                for (var _a = 0, ranges_1 = ranges; _a < ranges_1.length; _a++) {\n                    var range = ranges_1[_a];\n                    for (var _b = 0, _c = Object.keys(state.schema.marks); _b < _c.length; _b++) {\n                        var markName = _c[_b];\n                        tr.removeMark(range.$from.pos, range.$to.pos, state.schema.marks[markName]);\n                    }\n                }\n                dispatch(tr);\n            }\n        }\n        return true;\n    };\n}\n","export function DcImageLinkNode() {\n    return {\n        content: \"block\",\n        group: \"block\",\n        defining: true,\n        attrs: {\n            value: {}\n        },\n        nodeSize: 1,\n        draggable: true,\n        atom: true,\n        parseDOM: [\n            {\n                tag: \"dc-image-link[data-dc-image-link]\",\n                getAttrs: function (dom) {\n                    var value = JSON.parse(dom.getAttribute(\"data-dc-image-link\"));\n                    return {\n                        value: value\n                    };\n                }\n            }\n        ],\n        toDOM: function (node) {\n            var value = node.attrs.value;\n            return [\"dc-image-link\", { \"data-dc-image-link\": JSON.stringify(value) }];\n        }\n    };\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React from \"react\";\nimport { withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nvar styles = {\n    root: {\n        display: \"block\",\n        width: \"100%\",\n        minHeight: 150,\n        margin: \"0 10px 10px 0\",\n        position: \"relative\"\n    },\n    content: {},\n    \"empty-slot\": {},\n    \"populated-slot\": {}\n};\nvar InlineChooser = function (props) {\n    var _a;\n    var classes = props.classes, children = props.children, className = props.className, _b = props.variant, variant = _b === void 0 ? \"empty\" : _b, aspectRatio = props.aspectRatio, other = __rest(props, [\"classes\", \"children\", \"className\", \"variant\", \"aspectRatio\"]);\n    var aspectRatioPaddingTop = React.useMemo(function () {\n        if (!aspectRatio) {\n            return undefined;\n        }\n        var components = aspectRatio.split(':');\n        if (components.length !== 2) {\n            return undefined;\n        }\n        return Math.round(Number(components[1]) / Number(components[0]) * 100) + '%';\n    }, [aspectRatio]);\n    return (React.createElement(\"div\", __assign({}, other, { className: clsx(classes.root, (_a = {},\n            _a[classes[\"empty-slot\"]] = variant === \"empty-slot\",\n            _a[classes[\"populated-slot\"]] = variant === \"populated-slot\",\n            _a), className) }), aspectRatio ? (React.createElement(React.Fragment, null,\n        React.createElement(\"div\", { style: { display: 'block', paddingTop: aspectRatioPaddingTop } }, \"\\u00A0\"),\n        React.createElement(\"div\", { className: clsx(classes.content) }, children))) : (React.createElement(\"div\", { className: clsx(classes.content) }, children))));\n};\nexport default withStyles(styles)(InlineChooser);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, DeleteIcon, StyledFab, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { CircularProgress, withStyles } from '@material-ui/core';\n// tslint:disable-next-line\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage';\nimport clsx from 'clsx';\nvar styles = {\n    root: {\n        '&$broken, &$invalid': {\n            background: '#e5e5e5'\n        }\n    },\n    image: {\n        maxWidth: '100%'\n    },\n    loading: {},\n    broken: {},\n    invalid: {},\n    statusIcons: {\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        position: 'absolute',\n        alignItems: 'center',\n        alignContent: 'center',\n        flexDirection: 'row',\n        justifyContent: 'center'\n    }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n    var _a;\n    var node = props.node, onDelete = props.onDelete, classes = props.classes, options = props.options;\n    var value = node.attrs.value;\n    // BrokenImageIcon\n    var _b = React.useState(false), broken = _b[0], setBroken = _b[1];\n    var _c = React.useState(false), loading = _c[0], setLoading = _c[1];\n    var handleLoading = React.useCallback(function () {\n        setLoading(true);\n    }, [setLoading]);\n    var handleError = React.useCallback(function () {\n        setBroken(true);\n        setLoading(false);\n    }, [setBroken, setLoading]);\n    var handleLoaded = React.useCallback(function () {\n        setBroken(false);\n        setLoading(false);\n    }, [setBroken, setLoading]);\n    var hasValidValue = value && value.endpoint && value.name;\n    //Workaround for ts-jest\n    var Fab = StyledFab;\n    return (React.createElement(\"div\", { className: clsx(classes.root, (_a = {},\n            _a[classes.broken] = broken,\n            _a[classes.loading] = loading,\n            _a[classes.invalid] = !hasValidValue,\n            _a)) },\n        React.createElement(InlineChooser, { variant: \"populated-slot\", aspectRatio: broken || loading || !hasValidValue ? '3:1' : undefined },\n            hasValidValue ?\n                (React.createElement(\"img\", { className: classes.image, src: \"//\" + (options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? options.dynamicContent.stagingEnvironment : value.defaultHost) + \"/i/\" + value.endpoint + \"/\" + encodeURIComponent(value.name), onLoadStart: handleLoading, onError: handleError, onLoad: handleLoaded, alt: \"\" })) : false,\n            React.createElement(\"div\", { className: classes.statusIcons }, loading ?\n                React.createElement(CircularProgress, null) :\n                (broken || !hasValidValue ? React.createElement(BrokenImageIcon, { fontSize: \"large\" }) : false)),\n            React.createElement(ChooserActions, { variant: \"populated-slot\" },\n                React.createElement(Fab, { variant: \"dark\", onClick: onDelete }, DeleteIcon)))));\n});\nvar DcImageLinkView = /** @class */ (function () {\n    function DcImageLinkView(node, view, getPos, options) {\n        if (options === void 0) { options = {}; }\n        this.node = node;\n        this.view = view;\n        this.getPos = getPos;\n        this.options = options;\n        this.dom = document.createElement('div');\n        this.handleDelete = this.handleDelete.bind(this);\n        this.render();\n    }\n    DcImageLinkView.prototype.handleDelete = function () {\n        var start = this.getPos();\n        var tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n        this.view.dispatch(tr);\n    };\n    DcImageLinkView.prototype.render = function () {\n        ReactDOM.render(withTheme(React.createElement(ViewComponent, { options: this.options, node: this.node, onDelete: this.handleDelete })), this.dom);\n    };\n    return DcImageLinkView;\n}());\nexport { DcImageLinkView };\n","export function DcContentLinkNode() {\n    return {\n        content: \"block\",\n        group: \"block\",\n        defining: true,\n        attrs: {\n            value: {}\n        },\n        nodeSize: 1,\n        draggable: true,\n        atom: true,\n        parseDOM: [\n            {\n                tag: \"dc-content-link[data-dc-content-link]\",\n                getAttrs: function (dom) {\n                    var value = JSON.parse(dom.getAttribute(\"data-dc-content-link\"));\n                    return {\n                        value: value\n                    };\n                }\n            }\n        ],\n        toDOM: function (node) {\n            var value = node.attrs.value;\n            return [\n                \"dc-content-link\",\n                { \"data-dc-content-link\": JSON.stringify(value) }\n            ];\n        }\n    };\n}\n","export var schemas = [\n    {\n        schema: 'https://www.bbr.com/content-type/audio-podcast',\n        name: 'Audio Podcast'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/banner',\n        name: 'Banner'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/body-image',\n        name: 'Body Image'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/hero-banner',\n        name: 'Hero Banner'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/social-sharing',\n        name: 'Social Sharing'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/video-amplience',\n        name: 'Video Amplience'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/video-youtube',\n        name: 'Video Youtube'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/quote',\n        name: 'Quote'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/recipe',\n        name: 'Recipe'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/feature-block',\n        name: 'Feature Block'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/article-card-list',\n        name: 'Article Card List'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/social-networks',\n        name: 'Social Networks'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/contact-points',\n        name: 'Contact Points'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/category-hero-banner',\n        name: 'Category Hero Banner'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/accordion',\n        name: 'Accordion'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/image-half-width-with-text',\n        name: 'Image Half Width'\n    },\n    {\n        schema: 'https://www.bbr.com/content-type/table',\n        name: 'Table'\n    }\n];\nexport var environments = [\n    {\n        virtual: 'mwm9783993hk12s0dgnki3n7z.staging.bigcontent.io',\n        env: 'https://app.amplience.net/content/#!/bbrsandbox/authoring/content-item/edit/',\n    },\n    {\n        virtual: '18psqzjt574qb1t9cwcxkoaze2.staging.bigcontent.io',\n        env: 'https://app.amplience.net/content/#!/bbrtest/authoring/content-item/edit/',\n    },\n    {\n        virtual: '175uz9hadktmi1jo9js8h0ebin.staging.bigcontent.io',\n        env: 'https://app.amplience.net/content/#!/bbrprodsupp/authoring/content-item/edit/',\n    },\n    {\n        virtual: '1o6pu8rbwadqi1h1g5kiosiurx.staging.bigcontent.io',\n        env: 'https://app.amplience.net/content/#!/bbrprod/authoring/content-item/edit/',\n    },\n];\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { withStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { ChooserActions, ContentItem as ContentItemIcon, DeleteIcon, getContentTypeCard, getContentTypeIcon, StyledFab, Visualization, withTheme } from 'unofficial-dynamic-content-ui';\nimport InlineChooser from '../InlineChooser/InlineChooser';\nimport { environments, schemas } from './contentSchemas';\nvar styles = {\n    root: {\n        '&$broken, &$invalid': {\n            background: '#e5e5e5'\n        },\n        boxShadow: \"0 1px 5px 0 rgba(23,32,44,.2), 0 2px 2px 0 rgba(23,32,44,.1), 0 3px 1px -2px rgba(23,32,44,.1)\"\n    },\n    invalid: {},\n    content: {\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundSize: \"contain\",\n        backgroundRepeat: \"no-repeat\",\n        backgroundPosition: \"50%\"\n    },\n    contentName: {\n        margin: \"20px\",\n        fontsize: \"20px\",\n    },\n    statusIcons: {\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        display: 'flex',\n        position: 'absolute',\n        alignItems: 'center',\n        alignContent: 'center',\n        flexDirection: 'row',\n        justifyContent: 'center'\n    },\n};\nvar convertSettings = function (settings) {\n    if (settings === undefined) {\n        return undefined;\n    }\n    else if (Array.isArray(settings)) {\n        var result_1 = {\n            cards: {},\n            icons: {},\n            aspectRatios: {}\n        };\n        settings.forEach(function (setting) {\n            if (setting.card) {\n                result_1.cards[setting.id] = setting.card;\n            }\n            if (setting.icon) {\n                result_1.icons[setting.id] = setting.icon;\n            }\n            if (setting.aspectRatio && result_1.aspectRatios) {\n                result_1.aspectRatios[setting.id] = setting.aspectRatio;\n            }\n        });\n        return result_1;\n    }\n    else {\n        return settings;\n    }\n};\nvar ViewComponent = withStyles(styles)(function (props) {\n    var _a;\n    var node = props.node, onDelete = props.onDelete, contentTypeName = props.contentTypeName, editLink = props.editLink, classes = props.classes, options = props.options;\n    var value = node.attrs.value;\n    var hasValidValue = value && value.id && value.contentType;\n    var contentLinkOptions = options.tools && options.tools[\"dc-content-link\"] ? options.tools[\"dc-content-link\"] : undefined;\n    var settings = contentLinkOptions ? convertSettings(contentLinkOptions.contentTypeSettings) : undefined;\n    var customIcon = settings && hasValidValue\n        ? getContentTypeIcon(settings, value.contentType)\n        : undefined;\n    var cardTemplateUrl = settings && hasValidValue ? getContentTypeCard(settings, value.contentType) : undefined;\n    var aspectRatio = settings && settings.aspectRatios && hasValidValue ? getContentTypeAspectRatio(settings.aspectRatios, value.contentType) : undefined;\n    //Workaround for ts-jest\n    var Fab = StyledFab;\n    return (React.createElement(\"div\", { className: clsx(classes.root, (_a = {}, _a[classes.invalid] = !hasValidValue, _a)) },\n        React.createElement(InlineChooser, { variant: \"populated-slot\", aspectRatio: aspectRatio || '3:1' },\n            React.createElement(\"div\", { className: clsx(classes.content), style: {\n                    backgroundImage: \"url(\" + (customIcon || ContentItemIcon) + \")\"\n                } },\n                React.createElement(\"div\", { className: clsx(classes.contentName), style: { textAlign: \"center\" } },\n                    \"Content Type: \",\n                    contentTypeName),\n                cardTemplateUrl && options && options.dynamicContent && options.dynamicContent.stagingEnvironment ? (React.createElement(Visualization, { template: cardTemplateUrl, params: {\n                        contentItemId: value.id,\n                        stagingEnvironment: options.dynamicContent.stagingEnvironment\n                    } })) : (false)),\n            React.createElement(\"div\", null,\n                React.createElement(ChooserActions, { variant: \"populated-slot\" },\n                    React.createElement(Fab, { variant: \"dark\" },\n                        React.createElement(\"a\", { href: editLink, target: '_blank', style: { cursor: 'pointer', height: '24px', display: 'flex' } },\n                            React.createElement(\"svg\", { version: \"1.1\", id: \"Layer_1_cache446\", xmlns: \"http://www.w3.org/2000/svg\", xmlnsXlink: \"http://www.w3.org/1999/xlink\", x: \"0px\", y: \"0px\", width: \"24px\", height: \"24px\", viewBox: \"0 0 32 32.07\", enableBackground: \"new 0 0 32 32.07\", xmlSpace: \"preserve\", preserveAspectRatio: \"xMidYMid meet\", focusable: \"false\", style: { verticalAlign: \"middle\" } },\n                                React.createElement(\"polygon\", { fill: \"#FFFFFF\", points: \"4.124,22.244 3.375,28.656 9.773,27.906\" }),\n                                React.createElement(\"rect\", { x: \"11.119\", y: \"6.823\", transform: \"matrix(-0.7072 -0.707 0.707 -0.7072 13.8315 39.5483)\", fill: \"#FFFFFF\", width: \"7.972\", height: \"20.174\" }),\n                                React.createElement(\"path\", { fill: \"#FFFFFF\", d: \"M20.397,5.976l5.658,5.658c0,0,2.055-2.08,2.637-2.659c0.581-0.581,0.516-1.514,0-2.03\\n                                        c-0.518-0.519-3.105-3.109-3.597-3.599c-0.573-0.574-1.542-0.521-2.062,0C22.512,3.868,20.397,5.976,20.397,5.976z\" })))),\n                    React.createElement(Fab, { variant: \"dark\", onClick: onDelete }, DeleteIcon))))));\n});\nexport function getContentTypeAspectRatio(aspectRatios, schemaId) {\n    for (var _i = 0, _a = Object.keys(aspectRatios); _i < _a.length; _i++) {\n        var key = _a[_i];\n        if (key === \"*\" || key === schemaId) {\n            return aspectRatios[key];\n        }\n    }\n}\nvar DcContentLinkView = /** @class */ (function () {\n    function DcContentLinkView(node, view, getPos, options) {\n        if (options === void 0) { options = {}; }\n        this.node = node;\n        this.view = view;\n        this.getPos = getPos;\n        this.options = options;\n        this.dom = document.createElement('div');\n        this.handleDelete = this.handleDelete.bind(this);\n        this.beforeRender();\n        this.render();\n    }\n    DcContentLinkView.prototype.handleDelete = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var start, tr;\n            return __generator(this, function (_a) {\n                start = this.getPos();\n                tr = this.view.state.tr.delete(start, start + this.node.nodeSize);\n                this.view.dispatch(tr);\n                return [2 /*return*/];\n            });\n        });\n    };\n    DcContentLinkView.prototype.beforeRender = function () {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_c) {\n                this.editLink = ((_a = environments.find(function (item) { var _a; return item.virtual === ((_a = _this.options.dynamicContent) === null || _a === void 0 ? void 0 : _a.stagingEnvironment); })) === null || _a === void 0 ? void 0 : _a.env) + this.node.attrs.value.id;\n                this.contentTypeName = (_b = schemas.find(function (item) { return item.schema === _this.node.attrs.value.contentType; })) === null || _b === void 0 ? void 0 : _b.name;\n                return [2 /*return*/];\n            });\n        });\n    };\n    DcContentLinkView.prototype.render = function () {\n        ReactDOM.render(withTheme(React.createElement(ViewComponent, { options: this.options, node: this.node, contentTypeName: this.contentTypeName, editLink: this.editLink, onDelete: this.handleDelete })), this.dom);\n    };\n    return DcContentLinkView;\n}());\nexport { DcContentLinkView };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React from \"react\";\nimport { isToolEnabled, inBlock, } from \"@dc-extension-rich-text/common\";\n// tslint:disable-next-line\nimport AddCircleIcon from \"@material-ui/icons/AddCircle\";\n// tslint:disable-next-line\nimport ImageSearchIcon from \"@material-ui/icons/ImageSearch\";\nexport function dcImageLink(schema) {\n    var _this = this;\n    var node = schema.nodes[\"dc-image-link\"];\n    return {\n        name: \"dc-image-link\",\n        label: \"Insert Image\",\n        displayIcon: React.createElement(ImageSearchIcon, null),\n        isEnabled: function (state) { return !inBlock(state); },\n        apply: function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n            var value, err_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, richTextEditorContext.dialogs.getDcImageLink()];\n                    case 1:\n                        value = _a.sent();\n                        dispatch(state.tr.replaceSelectionWith(node.createAndFill({\n                            value: value,\n                        })));\n                        return [3 /*break*/, 3];\n                    case 2:\n                        err_1 = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); },\n    };\n}\nexport function dcContentLink(schema, contentTypes) {\n    var _this = this;\n    var node = schema.nodes[\"dc-content-link\"];\n    return {\n        name: \"dc-content-link\",\n        label: \"Insert Content\",\n        displayIcon: React.createElement(AddCircleIcon, null),\n        isEnabled: function (state) { return !inBlock(state); },\n        apply: function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n            var value, err_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, richTextEditorContext.dialogs.getDcContentLink(contentTypes)];\n                    case 1:\n                        value = _a.sent();\n                        dispatch(state.tr.replaceSelectionWith(node.createAndFill({\n                            value: value,\n                        })));\n                        return [3 /*break*/, 3];\n                    case 2:\n                        err_2 = _a.sent();\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        }); },\n    };\n}\nexport function createDynamicContentTools(schema, options) {\n    var tools = [];\n    if (isToolEnabled(\"dc-image-link\", options) &&\n        schema.nodes[\"dc-image-link\"]) {\n        tools.push(dcImageLink(schema));\n    }\n    if (isToolEnabled(\"dc-content-link\", options) &&\n        schema.nodes[\"dc-content-link\"] &&\n        // must provide a list of content types for this tool to be active\n        options.tools &&\n        options.tools[\"dc-content-link\"] &&\n        options.tools[\"dc-content-link\"].contentTypes &&\n        options.tools[\"dc-content-link\"].contentTypes) {\n        tools.push(dcContentLink(schema, options.tools[\"dc-content-link\"].contentTypes));\n    }\n    return tools;\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { FormatAlignCenter, FormatAlignJustify, FormatAlignLeft, FormatAlignRight } from \"@material-ui/icons\";\nimport React from \"react\";\nfunction getContainingTextBlocks(state) {\n    var resultNodes = new Set();\n    var result = [];\n    state.doc.nodesBetween(state.selection.from, state.selection.to, function (node, pos, parent, index) {\n        if (node.isTextblock && !resultNodes.has(node)) {\n            result.push({ node: node, pos: pos, start: 0, depth: 0 });\n            resultNodes.add(node);\n        }\n    });\n    return Array.from(result);\n}\nfunction align(state, dispatch, alignment) {\n    // Apply align attr to the text block.\n    var result = getContainingTextBlocks(state);\n    var tr = state.tr;\n    result.forEach(function (item) {\n        var node = item.node, pos = item.pos;\n        tr = tr.setNodeMarkup(pos, node.type, __assign(__assign({}, node.attrs), { align: alignment }));\n    });\n    if (dispatch) {\n        dispatch(tr);\n    }\n    return true;\n}\nfunction alignActive(state, view, alignment) {\n    // Apply align attr to the text block.\n    var result = getContainingTextBlocks(state);\n    var anyMismatch = false;\n    result.forEach(function (item) {\n        if ((result[0].node.attrs.align || \"left\") !== alignment) {\n            anyMismatch = true;\n        }\n    });\n    if (result.length === 0) {\n        return false;\n    }\n    return !anyMismatch;\n}\nfunction alignable(state, view) {\n    // Any text block is alignable.\n    return getContainingTextBlocks(state).length > 0;\n}\nexport function AlignLeftTool(schema) {\n    return {\n        name: \"align_left\",\n        label: \"Align Left\",\n        displayIcon: React.createElement(FormatAlignLeft, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"left\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"left\"); },\n        isVisible: alignable,\n    };\n}\nexport function AlignCenterTool(schema) {\n    return {\n        name: \"align_center\",\n        label: \"Align center\",\n        displayIcon: React.createElement(FormatAlignCenter, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"center\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"center\"); },\n        isVisible: alignable,\n    };\n}\nexport function AlignRightTool(schema) {\n    return {\n        name: \"align_right\",\n        label: \"Align Right\",\n        displayIcon: React.createElement(FormatAlignRight, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"right\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"right\"); },\n        isVisible: alignable,\n    };\n}\nexport function AlignJustifyTool(schema) {\n    return {\n        name: \"align_justify\",\n        label: \"Align Justify\",\n        displayIcon: React.createElement(FormatAlignJustify, null),\n        apply: function (state, dispatch) { return align(state, dispatch, \"justify\"); },\n        isActive: function (state, view) { return alignActive(state, view, \"justify\"); },\n        isVisible: alignable,\n    };\n}\n","// tslint:disable-next-line\nexport var anchor = {\n    group: \"inline\",\n    inline: true,\n    attrs: {\n        value: {}\n    },\n    parseDOM: [\n        {\n            tag: \"a[id]\",\n            getAttrs: function (dom) {\n                var value = JSON.parse(dom.getAttribute(\"id\"));\n                return {\n                    value: value\n                };\n            }\n        }\n    ],\n    toDOM: function (node) {\n        var value = node.attrs.value;\n        return [\"a\", { id: JSON.stringify(value) }, value];\n    }\n};\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { canInsert } from \"@dc-extension-rich-text/common\";\nimport { Directions } from \"@material-ui/icons\";\nimport React from \"react\";\nexport function AnchorTool(schema) {\n    return {\n        name: \"anchor\",\n        label: \"Insert Anchor\",\n        displayIcon: React.createElement(Directions, null),\n        apply: insertAnchor(schema.nodes.anchor),\n        isEnabled: function (state) { return canInsert(state, schema.nodes.anchor); },\n    };\n}\nexport function insertAnchor(type) {\n    var _this = this;\n    return function (state, dispatch, richTextEditorContext) { return __awaiter(_this, void 0, void 0, function () {\n        var existingAnchors_1, addAnchor_1, _a, $from, $to, anchorValue, err_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 2, , 3]);\n                    existingAnchors_1 = new Set();\n                    addAnchor_1 = function (node) {\n                        if (node.type.name === 'anchor') {\n                            existingAnchors_1.add(node.attrs.value);\n                        }\n                        else {\n                            node.forEach(addAnchor_1);\n                        }\n                    };\n                    state.doc.forEach(addAnchor_1);\n                    _a = state.selection, $from = _a.$from, $to = _a.$to;\n                    state.doc.nodesBetween($from.pos, $to.pos, function (node, start) {\n                        if (node.type.name === 'anchor') {\n                            existingAnchors_1.delete(node.attrs.value);\n                        }\n                    });\n                    return [4 /*yield*/, richTextEditorContext.dialogs.getAnchor(existingAnchors_1)];\n                case 1:\n                    anchorValue = _b.sent();\n                    dispatch(state.tr.replaceSelectionWith(type.createAndFill({\n                        value: anchorValue.value\n                    })));\n                    return [3 /*break*/, 3];\n                case 2:\n                    err_1 = _b.sent();\n                    return [3 /*break*/, 3];\n                case 3: return [2 /*return*/];\n            }\n        });\n    }); };\n}\n","export var AnchorToMarkdown = {\n    anchor: function (state, node) {\n        var attrs = {};\n        if (node.attrs.value) {\n            attrs.id = node.attrs.value;\n        }\n        var attrsSerialized = Object.keys(attrs)\n            .map(function (key) { return key + \"=\\\"\" + attrs[key] + \"\\\"\"; })\n            .join(\" \");\n        state.write(\"<a \" + attrsSerialized + \"></a>\");\n    }\n};\n","/**\n * Non-standard tool for applying a css class name to a region of the document\n */\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n// tslint:disable-next-line\nexport var inline_styles = {\n    attrs: {\n        class: { default: \"\" },\n        style: { default: \"\" }\n    },\n    group: \"inline\",\n    parseDOM: [\n        {\n            tag: \"span\",\n            getAttrs: function (node) {\n                return {\n                    class: node.getAttribute(\"class\"),\n                    style: node.attributes.style ? node.attributes.style.value : undefined\n                };\n            }\n        }\n    ],\n    toDOM: function (mark) {\n        return [\n            \"span\",\n            __assign(__assign({}, (mark.attrs.style ? { style: mark.attrs.style } : {})), { class: mark && mark.attrs && mark.attrs.class ? mark.attrs.class : \"\" }),\n            0\n        ];\n    }\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nfunction rangeHasFilteredMark(doc, from, to, type, filter) {\n    var found = false;\n    if (to > from) {\n        doc.nodesBetween(from, to, function (node) {\n            if (type.isInSet(node.marks) && node.marks.filter(filter).length > 0) {\n                found = true;\n            }\n            return !found;\n        });\n    }\n    return found;\n}\nexport function isFilteredMarkActive(state, type, filter) {\n    var _a = state.selection, from = _a.from, $from = _a.$from, to = _a.to, empty = _a.empty;\n    if (empty) {\n        if (!type.isInSet(state.storedMarks || $from.marks())) {\n            return false;\n        }\n        var validMarks = (state.storedMarks || $from.marks()).filter(filter);\n        return validMarks.length > 0;\n    }\n    else {\n        return rangeHasFilteredMark(state.doc, from, to, type, filter);\n    }\n}\nfunction getMarkFromRange(state, from, to, markType) {\n    var result;\n    if (to > from) {\n        state.doc.nodesBetween(from, to, function (node) {\n            if (markType.isInSet(node.marks)) {\n                result = node.marks.find(function (x) { return x.type === markType; });\n                return false;\n            }\n            return true;\n        });\n    }\n    return result;\n}\nfunction getStoredMark(state, markType) {\n    var ref = state.selection;\n    var $cursor = ref.$cursor;\n    if ($cursor) {\n        return (state.storedMarks || $cursor.marks()).find(function (x) { return x.type === markType; });\n    }\n}\nfunction mergeAttrs(oldAttrs, newAttrs) {\n    return __assign(__assign({}, oldAttrs), newAttrs);\n}\nexport function setMarkAttributes(markType, attrs) {\n    return function (state, dispatch) {\n        var ref = state.selection;\n        var $cursor = ref.$cursor;\n        var ranges = ref.ranges;\n        if (dispatch) {\n            if ($cursor) {\n                if (markType.isInSet(state.storedMarks || $cursor.marks())) {\n                    var existingMark = getStoredMark(state, markType);\n                    dispatch(state.tr.removeStoredMark(markType));\n                    if (existingMark) {\n                        dispatch(state.tr.addStoredMark(markType.create(mergeAttrs(existingMark.attrs, attrs))));\n                    }\n                }\n                else {\n                    dispatch(state.tr.addStoredMark(markType.create(attrs)));\n                }\n            }\n            else {\n                var has = false;\n                var tr = state.tr;\n                for (var i = 0; !has && i < ranges.length; i++) {\n                    var ref$1 = ranges[i];\n                    var $from = ref$1.$from;\n                    var $to = ref$1.$to;\n                    has = state.doc.rangeHasMark($from.pos, $to.pos, markType);\n                }\n                for (var _i = 0, ranges_1 = ranges; _i < ranges_1.length; _i++) {\n                    var ref$2 = ranges_1[_i];\n                    var $from$1 = ref$2.$from;\n                    var $to$1 = ref$2.$to;\n                    if (has) {\n                        var markAttrs = __assign({}, getMarkFromRange(state, $from$1.pos, $to$1.pos, markType).attrs);\n                        tr.removeMark($from$1.pos, $to$1.pos, markType);\n                        tr.addMark($from$1.pos, $to$1.pos, markType.create(mergeAttrs(markAttrs, attrs)));\n                    }\n                    else {\n                        tr.addMark($from$1.pos, $to$1.pos, markType.create(attrs));\n                    }\n                }\n                dispatch(tr.scrollIntoView());\n            }\n        }\n        return true;\n    };\n}\n","import { isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport React from 'react';\nimport { isFilteredMarkActive, setMarkAttributes } from \"../utils/MarkUtils\";\nexport function inlineStyleClassNameTool(schema, className, classLabel) {\n    var mark = schema.marks.inline_styles;\n    return {\n        name: \"inline_styles_className_\" + className,\n        label: classLabel,\n        displayLabel: React.createElement(\"span\", { className: className }, classLabel),\n        apply: setMarkAttributes(mark, { class: className }),\n        isEnabled: function (state) { return true; },\n        isActive: function (state) { return isFilteredMarkActive(state, mark, function (m) { return m.attrs.class === className; }); },\n    };\n}\nexport function createInlineStylesTools(schema, options) {\n    var tools = [];\n    if (schema.marks.inline_styles && isToolEnabled('inline_styles', options) && options.tools && options.tools.inline_styles) {\n        var inlineStylesOptions = options.tools.inline_styles;\n        if (inlineStylesOptions.classNames) {\n            for (var _i = 0, _a = inlineStylesOptions.classNames; _i < _a.length; _i++) {\n                var className = _a[_i];\n                tools.push(inlineStyleClassNameTool(schema, className.className, className.label));\n            }\n        }\n    }\n    return tools;\n}\n","export var InlineStylesToMarkdown = {\n    inline_styles: {\n        open: function (state, mark, parent, index) {\n            var attrs = {};\n            if (mark.attrs.class) {\n                attrs.class = mark.attrs.class;\n            }\n            var attrsSerialized = Object.keys(attrs)\n                .map(function (key) { return key + \"=\\\"\" + attrs[key] + \"\\\"\"; })\n                .join(\" \");\n            if (attrsSerialized.length > 0) {\n                return \"<span \" + attrsSerialized + \">\";\n            }\n            else {\n                return \"<span>\";\n            }\n        },\n        close: \"</span>\"\n    }\n};\n","// HTML block\n\"use strict\";\nvar blockNames = [\n    \"address\",\n    \"article\",\n    \"aside\",\n    \"base\",\n    \"basefont\",\n    \"blockquote\",\n    \"body\",\n    \"caption\",\n    \"center\",\n    \"col\",\n    \"colgroup\",\n    \"dd\",\n    \"details\",\n    \"dialog\",\n    \"dir\",\n    \"div\",\n    \"dl\",\n    \"dt\",\n    \"fieldset\",\n    \"figcaption\",\n    \"figure\",\n    \"footer\",\n    \"form\",\n    \"frame\",\n    \"frameset\",\n    \"h1\",\n    \"h2\",\n    \"h3\",\n    \"h4\",\n    \"h5\",\n    \"h6\",\n    \"head\",\n    \"header\",\n    \"hr\",\n    \"html\",\n    \"iframe\",\n    \"legend\",\n    \"li\",\n    \"link\",\n    \"main\",\n    \"menu\",\n    \"menuitem\",\n    \"meta\",\n    \"nav\",\n    \"noframes\",\n    \"ol\",\n    \"optgroup\",\n    \"option\",\n    \"p\",\n    \"param\",\n    \"section\",\n    \"source\",\n    \"summary\",\n    \"table\",\n    \"tbody\",\n    \"td\",\n    \"tfoot\",\n    \"th\",\n    \"thead\",\n    \"title\",\n    \"tr\",\n    \"track\",\n    \"ul\"\n];\nvar attrName = \"[a-zA-Z_:][a-zA-Z0-9:._-]*\";\nvar unquoted = \"[^\\\"'=<>`\\\\x00-\\\\x20]+\";\nvar singleQuoted = \"'[^']*'\";\nvar doubleQuoted = '\"[^\"]*\"';\nvar attrValue = \"(?:\" + unquoted + \"|\" + singleQuoted + \"|\" + doubleQuoted + \")\";\nvar attribute = \"(?:\\\\s+\" + attrName + \"(?:\\\\s*=\\\\s*\" + attrValue + \")?)\";\nvar openTag = \"<[A-Za-z][A-Za-z0-9\\\\-]*\" + attribute + \"*\\\\s*\\\\/?>\";\nvar closeTag = \"<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>\";\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp(\"^(?:\" + openTag + \"|\" + closeTag + \")\");\n// An array of opening and corresponding closing sequences for html tags,\n// last argument defines whether it can terminate a paragraph or not\n//\nvar HTML_SEQUENCES = [\n    [/^<(script|pre|style)(?=(\\s|>|$))/i, /<\\/(script|pre|style)>/i, true],\n    [/^<!--/, /-->/, true],\n    [/^<\\?/, /\\?>/, true],\n    [/^<![A-Z]/, />/, true],\n    [/^<!\\[CDATA\\[/, /\\]\\]>/, true],\n    [\n        new RegExp(\"^</?(\" + blockNames.join(\"|\") + \")(?=(\\\\s|/?>|$))\", \"i\"),\n        /^$/,\n        true\n    ],\n    [new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + \"\\\\s*$\"), /^$/, false]\n];\nexport function html_block(state, startLine, endLine, silent) {\n    var i;\n    var nextLine;\n    var token;\n    var lineText;\n    var pos = state.bMarks[startLine] + state.tShift[startLine];\n    var max = state.eMarks[startLine];\n    // if it's indented more than 3 spaces, it should be a code block\n    if (state.sCount[startLine] - state.blkIndent >= 4) {\n        return false;\n    }\n    if (!state.md.options.html) {\n        return false;\n    }\n    if (state.src.charCodeAt(pos) !== 0x3c /* < */) {\n        return false;\n    }\n    lineText = state.src.slice(pos, max);\n    for (i = 0; i < HTML_SEQUENCES.length; i++) {\n        if (HTML_SEQUENCES[i][0].test(lineText)) {\n            break;\n        }\n    }\n    if (i === HTML_SEQUENCES.length) {\n        return false;\n    }\n    if (silent) {\n        // true if this sequence can be a terminator, false otherwise\n        return HTML_SEQUENCES[i][2];\n    }\n    nextLine = startLine + 1;\n    // If we are here - we detected HTML block.\n    // Let's roll down till block end.\n    if (!HTML_SEQUENCES[i][1].test(lineText)) {\n        for (; nextLine < endLine; nextLine++) {\n            if (state.sCount[nextLine] < state.blkIndent) {\n                break;\n            }\n            pos = state.bMarks[nextLine] + state.tShift[nextLine];\n            max = state.eMarks[nextLine];\n            lineText = state.src.slice(pos, max);\n            if (HTML_SEQUENCES[i][1].test(lineText)) {\n                if (lineText.length !== 0) {\n                    nextLine++;\n                }\n                break;\n            }\n        }\n    }\n    var content = state.getLines(startLine, nextLine, state.blkIndent, true);\n    var dom = new DOMParser().parseFromString(content, \"text/html\");\n    var tag = dom.body.firstChild;\n    var innerContent = tag == null ? \"\" : tag.innerHTML;\n    state.line = nextLine;\n    token = state.push(\"html_block_open\", \"\", 1);\n    token.meta = { tag: tag.tagName, attrs: Array.from(tag.attributes) };\n    token.map = [startLine, state.line];\n    token = state.push(\"inline\", \"\", 0);\n    token.map = [startLine, nextLine];\n    token.content = innerContent;\n    token.children = [];\n    token = state.push(\"html_block_close\", \"\", -1);\n    token.meta = { tag: tag.tagName };\n    return true;\n}\n","// Process &shy;\nexport function soft_hyphen_from(state, silent) {\n    var pos = state.pos;\n    if (state.src.slice(pos, pos + 5) !== \"&shy;\") {\n        return false;\n    }\n    if (!silent) {\n        var content = state.src.slice(pos, pos + 5);\n        var token = state.push(\"soft_hyphen\", \"shy\", 0);\n        token.attrs = [];\n        token.content = content;\n    }\n    state.pos = pos + 5;\n    return true;\n}\n","// tslint:disable-next-line\nexport var soft_hyphen = {\n    group: \"inline\",\n    inline: true,\n    parseDOM: [\n        {\n            tag: \"span[data-shy]\",\n            getAttrs: function (dom) {\n                return {};\n            }\n        }\n    ],\n    toDOM: function (node) {\n        return [\"span\", { \"data-shy\": true }, \"-\"];\n    }\n};\n","export var SoftHyphenToMarkdown = {\n    soft_hyphen: function (state, node) {\n        state.write(\"&shy;\");\n    }\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { getDefaultClass } from \"@dc-extension-rich-text/common\";\nimport { html_block } from \"../alignment\";\nimport { soft_hyphen_from } from \"../soft_hyphen\";\n// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\n// tslint:disable-next-line\nvar markdownit = require(\"markdown-it\");\n// tslint:disable-next-line\nvar markdownItTable = require(\"markdown-it-table\").markdownItTable;\nexport function createMarkdownParser(schema, options) {\n    var md = markdownit(\"commonmark\", { html: true });\n    md.use(markdownItTable);\n    md.inline.ruler.before(\"text\", \"soft_hyphen\", soft_hyphen_from);\n    md.block.ruler.before(\"html_block\", \"html_block\", html_block);\n    // Patch parser to detect <span></span> tags and convert into inline_styles marks\n    // Warning... this might be a little brittle\n    var parser = new markdown.MarkdownParser(schema, md, __assign(__assign({}, markdown.defaultMarkdownParser.tokens), { anchor: {\n            node: \"anchor\",\n            getAttrs: function (tok) { return ({\n                value: tok.attrGet(\"value\")\n            }); }\n        }, fence: {\n            block: \"code_block\",\n            getAttrs: function (tok) { return ({ params: tok.info || \"\" }); },\n            noCloseToken: true\n        }, soft_hyphen: { node: \"soft_hyphen\" }, table: { block: \"table\" }, th: {\n            block: \"table_header\",\n            getAttrs: function (tok) { return ({\n                style: tok.attrGet(\"style\")\n            }); }\n        }, tr: { block: \"table_row\" }, td: {\n            block: \"table_cell\",\n            getAttrs: function (tok) { return ({\n                style: tok.attrGet(\"style\")\n            }); }\n        } }));\n    parser.tokenHandlers.html_inline = function (state, token) {\n        if (!token || !token.content) {\n            return;\n        }\n        var content = (token.content || \"\").trim();\n        if (content.startsWith(\"<span\") && content.endsWith(\">\")) {\n            var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n            var tag = dom.body.firstChild;\n            if (!tag) {\n                return;\n            }\n            if (tag.nodeName.toLowerCase() === \"span\") {\n                var className = tag.getAttribute(\"class\");\n                state.openMark(schema.marks.inline_styles.create({\n                    class: className\n                }));\n            }\n        }\n        else if (content === \"</span>\") {\n            state.closeMark(schema.marks.inline_styles);\n        }\n        else if (content.startsWith(\"<a\") && content.endsWith(\">\")) {\n            var dom = new DOMParser().parseFromString(token.content, \"text/html\");\n            var tag = dom.body.firstChild;\n            if (!tag) {\n                return;\n            }\n            if (tag.nodeName.toLowerCase() === \"a\") {\n                var id = tag.getAttribute(\"id\");\n                if (id != null) {\n                    state.addNode(schema.nodes.anchor, {\n                        value: id\n                    });\n                }\n            }\n        }\n        else if (content === \"<br>\") {\n            state.addNode(schema.nodes.hard_break);\n        }\n    };\n    var alignedParagraphTypes = new Map([\n        [\"P\", \"paragraph\"],\n        [\"H1\", \"heading\"],\n        [\"H2\", \"heading\"],\n        [\"H3\", \"heading\"],\n        [\"H4\", \"heading\"],\n        [\"H5\", \"heading\"],\n        [\"H6\", \"heading\"]\n    ]);\n    var alignmentClasses = new Map([\n        [\"amp-align-left\", \"left\"],\n        [\"amp-align-center\", \"center\"],\n        [\"amp-align-right\", \"right\"],\n        [\"amp-align-justify\", \"justify\"]\n    ]);\n    // tslint:disable-next-line\n    parser.tokenHandlers.html_block_open = function (state, token) {\n        if (!alignedParagraphTypes.has(token.meta.tag)) {\n            return;\n        }\n        var styleAttr = token.meta.attrs.find(function (attr) { return attr.name === \"style\"; });\n        var alignAttr = \"left\";\n        if (styleAttr) {\n            alignAttr =\n                styleAttr.ownerElement.style.textAlign || alignAttr;\n        }\n        var classAttr = token.meta.attrs.find(function (attr) { return attr.name === \"class\"; });\n        if (classAttr) {\n            // Styles may be present in classes instead\n            classAttr.ownerElement.classList.forEach(function (value) {\n                var asDefault = getDefaultClass(value, options);\n                alignAttr = alignmentClasses.get(asDefault) || \"left\";\n            });\n        }\n        var nodeType = alignedParagraphTypes.get(token.meta.tag);\n        var level = nodeType === \"heading\" ? Number(token.meta.tag[1]) : undefined;\n        state.openNode(schema.nodes[nodeType], {\n            align: alignAttr ? alignAttr : \"left\",\n            level: level\n        });\n    };\n    // tslint:disable-next-line\n    parser.tokenHandlers.html_block_close = function (state, token) {\n        if (alignedParagraphTypes.has(token.meta.tag)) {\n            state.closeNode();\n        }\n    };\n    return parser;\n}\n","import { getCustomClass } from \"@dc-extension-rich-text/common\";\n// tslint:disable-next-line\nexport var paragraph_align = {\n    content: \"inline*\",\n    attrs: {\n        align: { default: \"left\" }\n    },\n    group: \"block\",\n    parseDOM: [\n        {\n            tag: \"p\",\n            getAttrs: function (dom) {\n                return { align: dom.style.textAlign };\n            }\n        }\n    ],\n    toDOM: function (node) {\n        return [\"p\", { style: \"text-align: \" + (node.attrs.align || \"left\") }, 0];\n    }\n};\nfunction getHeadingAttrs(level) {\n    return function getAttrs(dom) {\n        return { align: dom.style.textAlign, level: level };\n    };\n}\n// tslint:disable-next-line\nexport var heading_align = {\n    attrs: {\n        level: { default: 1 },\n        align: { default: \"left\" }\n    },\n    content: \"inline*\",\n    group: \"block\",\n    defining: true,\n    parseDOM: [\n        { tag: \"h1\", getAttrs: getHeadingAttrs(1) },\n        { tag: \"h2\", getAttrs: getHeadingAttrs(2) },\n        { tag: \"h3\", getAttrs: getHeadingAttrs(3) },\n        { tag: \"h4\", getAttrs: getHeadingAttrs(4) },\n        { tag: \"h5\", getAttrs: getHeadingAttrs(5) },\n        { tag: \"h6\", getAttrs: getHeadingAttrs(6) }\n    ],\n    toDOM: function (node) {\n        return [\n            \"h\" + node.attrs.level,\n            { style: \"text-align: \" + (node.attrs.align || \"left\") },\n            0\n        ];\n    }\n};\nexport var AlignedParagraphToMarkdown = function (options) { return ({\n    paragraph: function (state, node) {\n        if (node.attrs.align &&\n            node.attrs.align !== \"left\" &&\n            node.attrs.align !== \"start\") {\n            // Aligned paragraph\n            // Emit paragraph as HTML with the align attribute.\n            if (options.useClasses) {\n                state.write(\"<p class=\\\"\" + getCustomClass(\"amp-align-\" + node.attrs.align, options) + \"\\\">\");\n            }\n            else {\n                state.write(\"<p style=\\\"text-align: \" + node.attrs.align + \"\\\">\");\n            }\n            state.renderInline(node);\n            state.write(\"</p>\");\n            state.closeBlock(node);\n        }\n        else {\n            state.renderInline(node);\n            state.closeBlock(node);\n        }\n    }\n}); };\nexport var AlignedHeaderToMarkdown = function (options) { return ({\n    heading: function (state, node) {\n        if (node.attrs.align &&\n            node.attrs.align !== \"left\" &&\n            node.attrs.align !== \"start\") {\n            // Aligned header\n            // Emit header as HTML with the align attribute.\n            if (options.useClasses) {\n                state.write(\"<h\" + node.attrs.level + \" class=\\\"\" + getCustomClass(\"amp-align-\" + node.attrs.align, options) + \"\\\">\");\n            }\n            else {\n                state.write(\"<h\" + node.attrs.level + \" style=\\\"text-align: \" + node.attrs.align + \"\\\">\");\n            }\n            state.renderInline(node);\n            state.write(\"</h\" + node.attrs.level + \">\");\n            state.closeBlock(node);\n        }\n        else {\n            state.write(state.repeat(\"#\", node.attrs.level) + \" \");\n            state.renderInline(node);\n            state.closeBlock(node);\n        }\n    }\n}); };\n","var defaultRowWidth = 8;\nfunction tableRemoveNewlines(input) {\n    return input\n        .trimEnd()\n        .replace(/\\\\?\\n/g, \"<br>\")\n        .padEnd(defaultRowWidth, \" \");\n}\nfunction withTableEscapes(state, action) {\n    var start = state.out.length;\n    action();\n    state.out =\n        state.out.substr(0, start) + tableRemoveNewlines(state.out.substr(start));\n    state.closed = false;\n}\nexport var TableToMarkdown = {\n    table: function (state, node) {\n        var rows = [];\n        for (var i = 0; i < node.childCount; i++) {\n            var child = node.maybeChild(i);\n            if (child != null && child.type.name === \"table_row\") {\n                rows.push(child);\n            }\n        }\n        if (rows.length === 0) {\n            return;\n        }\n        // First row is the header row. Get column count, and draw it.\n        state.render(rows[0]);\n        var columnCount = rows[0].childCount; // Assumes first row is header.\n        // Draw divider using the number of columns.\n        state.write(\"\\n\");\n        for (var i = 0; i < columnCount; i++) {\n            state.write(\"|----------\");\n        }\n        state.write(\"|\");\n        // Second row onwards are regular rows.\n        for (var i = 1; i < rows.length; i++) {\n            state.write(\"\\n\");\n            state.render(rows[i]);\n        }\n        state.closeBlock(node);\n    },\n    table_row: function (state, node) {\n        state.write(\"| \");\n        var _loop_1 = function (i) {\n            var child = node.maybeChild(i);\n            if (child != null) {\n                if (i > 0) {\n                    state.write(\" | \");\n                }\n                withTableEscapes(state, function () {\n                    state.renderInline(child);\n                });\n            }\n        };\n        for (var i = 0; i < node.childCount; i++) {\n            _loop_1(i);\n        }\n        state.write(\" |\");\n    },\n    table_cell: function (state, node) {\n        state.renderInline(node);\n    },\n    table_header: function (state, node) {\n        state.renderInline(node);\n    }\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { AlignedHeaderToMarkdown, AlignedParagraphToMarkdown } from \"../alignment/AlignmentPlugin\";\nimport { AnchorToMarkdown } from \"../anchor\";\nimport { InlineStylesToMarkdown } from \"../inline_styles\";\nimport { SoftHyphenToMarkdown } from \"../soft_hyphen\";\nimport { TableToMarkdown } from \"../tables/TableToMarkdown\";\n// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\nfunction escape(text) {\n    return text\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\");\n}\nvar TextToMarkdown = {\n    text: function (state, node) {\n        state.text(escape(node.text));\n    }\n};\nexport function createMarkdownSerializer(options, serializers) {\n    if (serializers === void 0) { serializers = {}; }\n    return new markdown.MarkdownSerializer(__assign(__assign(__assign(__assign(__assign(__assign(__assign(__assign({}, markdown.defaultMarkdownSerializer.nodes), SoftHyphenToMarkdown), AnchorToMarkdown), TableToMarkdown), AlignedParagraphToMarkdown(options)), AlignedHeaderToMarkdown(options)), TextToMarkdown), serializers), __assign(__assign({}, markdown.defaultMarkdownSerializer.marks), InlineStylesToMarkdown));\n}\n","import { heading_align, paragraph_align } from \"../alignment/AlignmentPlugin\";\nimport { anchor } from \"../anchor\";\nimport { inline_styles } from \"../inline_styles\";\nimport { createMarkdownParser } from \"../markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"../markdown/MarkdownSerializer\";\nimport { soft_hyphen } from \"../soft_hyphen\";\n// tslint:disable-next-line\nvar tableNodes = require(\"prosemirror-tables\").tableNodes;\n// tslint:disable-next-line\nvar Schema = require(\"prosemirror-model\").Schema;\nexport function createSchema(options, isInlineStylesEnabled) {\n    if (isInlineStylesEnabled === void 0) { isInlineStylesEnabled = false; }\n    var schema = require(\"prosemirror-markdown\").schema;\n    // TODO: don't register nodes and marks that are disabled in the options\n    var marks = schema.spec.marks;\n    if (isInlineStylesEnabled) {\n        marks = marks.addToEnd(\"inline_styles\", inline_styles);\n    }\n    var nodes = schema.spec.nodes\n        .append(tableNodes({\n        tableGroup: \"block\",\n        cellContent: \"block\",\n        cellAttributes: {\n            background: {\n                default: null,\n                // tslint:disable-next-line\n                getFromDOM: function (dom) {\n                    return dom.style.backgroundColor || null;\n                },\n                // tslint:disable-next-line\n                setDOMAttr: function (value, attrs) {\n                    if (value) {\n                        attrs.style =\n                            (attrs.style || \"\") + (\"background-color: \" + value + \";\");\n                    }\n                }\n            }\n        }\n    }))\n        .addToEnd(\"soft_hyphen\", soft_hyphen)\n        .addToEnd(\"anchor\", anchor)\n        .update(\"paragraph\", paragraph_align)\n        .update(\"heading\", heading_align);\n    return new Schema({\n        nodes: nodes,\n        marks: marks\n    });\n}\nvar serializer;\nvar parser;\nexport function getDefaultSerializerParser(schema, options) {\n    if (serializer == null) {\n        serializer = createMarkdownSerializer(options);\n        parser = createMarkdownParser(schema, options);\n    }\n    return [serializer, parser];\n}\n","import { canInsert } from \"@dc-extension-rich-text/common\";\nimport { BorderClear, FirstPage, LastPage, TableChart, VerticalAlignBottom, VerticalAlignTop } from \"@material-ui/icons\";\nimport { addColumnAfter, addRowAfter, deleteColumn, deleteRow, deleteTable, } from \"prosemirror-tables\";\nimport React from \"react\";\n// tslint:disable-next-line: no-var-requires\nvar Fragment = require('prosemirror-model').Fragment;\nfunction inTable(state) {\n    var path = state.selection.$head.path;\n    for (var i = 0; i < path.length; i += 3) {\n        if (path[i].type.name === 'table') {\n            return true;\n        }\n    }\n    return false;\n}\nfunction generateEmptyCell(state, type) {\n    return type.create(undefined, Fragment.fromArray([\n        state.schema.nodes.paragraph.create()\n    ]));\n}\nfunction insertTable(state, dispatch) {\n    var tr = state.tr.replaceSelectionWith(state.schema.nodes.table.create(undefined, Fragment.fromArray([\n        state.schema.nodes.table_row.create(undefined, Fragment.fromArray([\n            generateEmptyCell(state, state.schema.nodes.table_header),\n            generateEmptyCell(state, state.schema.nodes.table_header),\n        ])),\n        state.schema.nodes.table_row.create(undefined, Fragment.fromArray([\n            generateEmptyCell(state, state.schema.nodes.table_cell),\n            generateEmptyCell(state, state.schema.nodes.table_cell),\n        ])),\n    ])));\n    if (dispatch) {\n        dispatch(tr);\n    }\n    return true;\n}\nexport function CreateTableTool(schema) {\n    return {\n        name: \"table_create\",\n        label: \"Create Table\",\n        displayIcon: React.createElement(TableChart, null),\n        apply: insertTable,\n        isEnabled: function (state) { return canInsert(state, schema.nodes.table); },\n        isVisible: function (state) { return !inTable(state); },\n    };\n}\nexport function AddRowTool(schema) {\n    return {\n        name: \"table_row_add\",\n        label: \"Add Row\",\n        displayIcon: React.createElement(VerticalAlignBottom, null),\n        apply: addRowAfter,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function AddColumnTool(schema) {\n    return {\n        name: \"table_col_add\",\n        label: \"Add Column\",\n        displayIcon: React.createElement(LastPage, null),\n        apply: addColumnAfter,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function DeleteRowTool(schema) {\n    return {\n        name: \"table_row_delete\",\n        label: \"Delete Row\",\n        displayIcon: React.createElement(VerticalAlignTop, null),\n        apply: deleteRow,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function DeleteColumnTool(schema) {\n    return {\n        name: \"table_col_delete\",\n        label: \"Delete Column\",\n        displayIcon: React.createElement(FirstPage, null),\n        apply: deleteColumn,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\nexport function DeleteTableTool(schema) {\n    return {\n        name: \"table_delete\",\n        label: \"Delete Table\",\n        displayIcon: React.createElement(BorderClear, null),\n        apply: deleteTable,\n        isVisible: function (state) { return inTable(state); },\n    };\n}\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { createStandardTools, isToolEnabled } from \"@dc-extension-rich-text/common\";\nimport { AlignCenterTool, AlignJustifyTool, AlignLeftTool, AlignRightTool } from \"./alignment/AlignmentTools\";\nimport { AnchorTool } from \"./anchor\";\nimport { createInlineStylesTools } from \"./inline_styles\";\nimport { createMarkdownParser } from \"./markdown/MarkdownParser\";\nimport { createMarkdownSerializer } from \"./markdown/MarkdownSerializer\";\nimport { createSchema } from \"./schema/createSchema\";\nimport { SoftHyphenTool } from \"./soft_hyphen\";\nimport { AddColumnTool, AddRowTool, CreateTableTool, DeleteColumnTool, DeleteRowTool, DeleteTableTool } from \"./tables/TableTools\";\nexport function createMarkdownTools(schema, options) {\n    var tools = [];\n    if (isToolEnabled(\"inline_styles\", options)) {\n        tools = tools.concat(tools, createInlineStylesTools(schema, options));\n    }\n    if (isToolEnabled(\"anchor\", options) && schema.nodes.anchor) {\n        tools.push(AnchorTool(schema));\n    }\n    if (isToolEnabled(\"soft_hyphen\", options) && schema.nodes.soft_hyphen) {\n        tools.push(SoftHyphenTool(schema));\n    }\n    // Alignment\n    if (isToolEnabled(\"align_left\", options)) {\n        tools.push(AlignLeftTool(schema));\n    }\n    if (isToolEnabled(\"align_center\", options)) {\n        tools.push(AlignCenterTool(schema));\n    }\n    if (isToolEnabled(\"align_right\", options)) {\n        tools.push(AlignRightTool(schema));\n    }\n    if (isToolEnabled(\"align_justify\", options)) {\n        tools.push(AlignJustifyTool(schema));\n    }\n    if (schema.nodes.table) {\n        if (isToolEnabled(\"table_create\", options)) {\n            tools.push(CreateTableTool(schema));\n        }\n        if (isToolEnabled(\"table_delete\", options)) {\n            tools.push(DeleteTableTool(schema));\n        }\n        if (isToolEnabled(\"table_row_add\", options)) {\n            tools.push(AddRowTool(schema));\n        }\n        if (isToolEnabled(\"table_col_add\", options)) {\n            tools.push(AddColumnTool(schema));\n        }\n        if (isToolEnabled(\"table_row_delete\", options)) {\n            tools.push(DeleteRowTool(schema));\n        }\n        if (isToolEnabled(\"table_col_delete\", options)) {\n            tools.push(DeleteColumnTool(schema));\n        }\n    }\n    return tools;\n}\nvar MarkdownLanguage = /** @class */ (function () {\n    function MarkdownLanguage(options) {\n        if (options === void 0) { options = {}; }\n        this.name = \"markdown\";\n        this.label = \"Markdown\";\n        var schema = this.createSchema(options);\n        var tools = __spreadArrays(createStandardTools(schema, options), createMarkdownTools(schema, options));\n        var serializer = createMarkdownSerializer(options, this.getNodeSerializers());\n        var parser = createMarkdownParser(schema, options);\n        this.schema = schema;\n        this.tools = tools;\n        this.serializer = serializer;\n        this.parser = parser;\n    }\n    MarkdownLanguage.prototype.serialize = function (doc) {\n        return this.serializeMarkdown(doc);\n    };\n    MarkdownLanguage.prototype.parse = function (data) {\n        return this.parseMarkdown(data);\n    };\n    MarkdownLanguage.prototype.serializeMarkdown = function (doc) {\n        return this.serializer.serialize(doc);\n    };\n    MarkdownLanguage.prototype.canSerializeNodeToMarkdown = function (schema, node) {\n        if (!node.type) {\n            return false;\n        }\n        else {\n            return this.serializer.nodes[node.type] != null;\n        }\n    };\n    MarkdownLanguage.prototype.parseMarkdown = function (data) {\n        if (!data) {\n            data = \"\";\n        }\n        return this.parser.parse(data);\n    };\n    MarkdownLanguage.prototype.getNodeSerializers = function () {\n        return {};\n    };\n    MarkdownLanguage.prototype.createSchema = function (options) {\n        if (options === void 0) { options = {}; }\n        var isInlineStylesEnabled = isToolEnabled(\"inline_styles\", options);\n        return createSchema(options, isInlineStylesEnabled);\n    };\n    return MarkdownLanguage;\n}());\nexport default MarkdownLanguage;\n","import { canInsert } from \"@dc-extension-rich-text/common\";\nimport { Remove } from \"@material-ui/icons\";\nimport React from \"react\";\nexport function SoftHyphenTool(schema) {\n    return {\n        name: \"soft_hyphen\",\n        label: \"Insert Soft Hyphen\",\n        displayIcon: React.createElement(Remove, null),\n        apply: function (state, dispatch) {\n            dispatch(state.tr.replaceSelectionWith(schema.nodes.soft_hyphen.create()));\n        },\n        isEnabled: function (state) { return canInsert(state, schema.nodes.soft_hyphen); },\n    };\n}\n","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n    format: RichLanguageFormat.TEXT\n};\nexport default conf;\n","import MarkdownLanguage from \"./MarkdownLanguage\";\nimport MarkdownLanguageConfiguration from \"./MarkdownLanguageConfiguration\";\nexport default function (options) {\n    return {\n        language: new MarkdownLanguage(options),\n        conf: MarkdownLanguageConfiguration\n    };\n}\nexport * from \"./schema/createSchema\";\nexport { createMarkdownTools } from \"./MarkdownLanguage\";\nexport * from \"./markdown/MarkdownParser\";\nexport * from \"./markdown/MarkdownSerializer\";\nexport { default as MarkdownLanguage } from \"./MarkdownLanguage\";\n","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\n// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar DcImageLinkBlock = /** @class */ (function () {\n    function DcImageLinkBlock() {\n    }\n    DcImageLinkBlock.prototype.canSerialize = function (schema, node) {\n        return node.type === \"dc-image-link\";\n    };\n    DcImageLinkBlock.prototype.serialize = function (schema, nodes) {\n        return nodes.map(function (node) {\n            return {\n                type: \"dc-image-link\",\n                data: node.attrs.value\n            };\n        });\n    };\n    DcImageLinkBlock.prototype.canParse = function (schema, block) {\n        return block.type === \"dc-image-link\";\n    };\n    DcImageLinkBlock.prototype.parse = function (schema, blocks) {\n        var result = [];\n        blocks.forEach(function (block) {\n            result.push({\n                type: \"dc-image-link\",\n                attrs: {\n                    value: block.data\n                }\n            });\n        });\n        return result;\n    };\n    return DcImageLinkBlock;\n}());\nexport default DcImageLinkBlock;\n","// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar MarkdownBlock = /** @class */ (function () {\n    function MarkdownBlock(options, markdownLanguage) {\n        this.options = options;\n        this.markdownLanguage = markdownLanguage;\n    }\n    MarkdownBlock.prototype.canSerialize = function (schema, node) {\n        return this.markdownLanguage.canSerializeNodeToMarkdown(schema, node);\n    };\n    MarkdownBlock.prototype.serialize = function (schema, nodes) {\n        var parsedNodes = Node.fromJSON(schema, {\n            type: \"doc\",\n            content: nodes\n        });\n        return [\n            {\n                type: \"markdown\",\n                data: this.markdownLanguage.serializeMarkdown(parsedNodes)\n            }\n        ];\n    };\n    MarkdownBlock.prototype.canParse = function (schema, block) {\n        return block.type === \"markdown\";\n    };\n    MarkdownBlock.prototype.parse = function (schema, blocks) {\n        var _this = this;\n        var result = [];\n        blocks.forEach(function (block) {\n            var doc = _this.markdownLanguage\n                .parseMarkdown(block.data || \"\")\n                .toJSON();\n            result = result.concat.apply(result, doc.content || []);\n        });\n        return result;\n    };\n    return MarkdownBlock;\n}());\nexport default MarkdownBlock;\n","import { RichLanguageFormat } from \"@dc-extension-rich-text/common\";\nvar conf = {\n    format: RichLanguageFormat.JSON\n};\nexport default conf;\n","// tslint:disable-next-line\nvar markdown = require(\"prosemirror-markdown\");\n// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar DcContentLinkBlock = /** @class */ (function () {\n    function DcContentLinkBlock() {\n    }\n    DcContentLinkBlock.prototype.canSerialize = function (schema, node) {\n        return node.type === \"dc-content-link\";\n    };\n    DcContentLinkBlock.prototype.serialize = function (schema, nodes) {\n        return nodes.map(function (node) {\n            return {\n                type: \"dc-content-link\",\n                data: node.attrs.value\n            };\n        });\n    };\n    DcContentLinkBlock.prototype.canParse = function (schema, block) {\n        return block.type === \"dc-content-link\";\n    };\n    DcContentLinkBlock.prototype.parse = function (schema, blocks) {\n        var result = [];\n        blocks.forEach(function (block) {\n            result.push({\n                type: \"dc-content-link\",\n                attrs: {\n                    value: block.data\n                }\n            });\n        });\n        return result;\n    };\n    return DcContentLinkBlock;\n}());\nexport default DcContentLinkBlock;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { MarkdownLanguage, } from \"@dc-extension-rich-text/language-markdown\";\nimport { createDynamicContentTools, DcContentLinkNode, DcImageLinkNode, } from \"@dc-extension-rich-text/prosemirror-dynamic-content\";\nimport DcContentLinkBlock from \"./blocks/DcContentLinkBlock\";\nimport DcImageLinkBlock from \"./blocks/DcImageLinkBlock\";\nimport MarkdownBlock from \"./blocks/MarkdownBlock\";\n// tslint:disable-next-line\nvar Schema = require(\"prosemirror-model\").Schema;\n// tslint:disable-next-line\nvar Node = require(\"prosemirror-model\").Node;\nvar JSONLanguage = /** @class */ (function (_super) {\n    __extends(JSONLanguage, _super);\n    function JSONLanguage(options, blockTypes) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, options) || this;\n        _this.name = \"json\";\n        _this.label = \"JSON\";\n        _this.markdownBlock = new MarkdownBlock(options, _this);\n        _this.blockTypes = blockTypes || [\n            new DcImageLinkBlock(),\n            new DcContentLinkBlock(),\n            _this.markdownBlock,\n        ];\n        _this.tools = __spreadArrays(_this.tools, createDynamicContentTools(_this.schema, options));\n        return _this;\n    }\n    JSONLanguage.prototype.serialize = function (doc) {\n        var _this = this;\n        if (!doc) {\n            return [];\n        }\n        doc = doc.toJSON();\n        var fragments = [];\n        if (!doc.content || doc.content.length === 0) {\n            return fragments;\n        }\n        var nodesByConverter = groupBy(doc.content, function (node) {\n            for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n                var blockType = _a[_i];\n                if (blockType.canSerialize(_this.schema, node)) {\n                    return blockType;\n                }\n            }\n        });\n        var blocks = [];\n        for (var _i = 0, nodesByConverter_1 = nodesByConverter; _i < nodesByConverter_1.length; _i++) {\n            var group = nodesByConverter_1[_i];\n            var groupBlocks = group.group.serialize(this.schema, group.items);\n            blocks = blocks.concat.apply(blocks, groupBlocks);\n        }\n        return blocks;\n    };\n    JSONLanguage.prototype.parse = function (blocks) {\n        var _this = this;\n        if (!blocks || blocks.length === 0) {\n            return Node.fromJSON(this.schema, {\n                type: \"doc\",\n                content: [\n                    {\n                        type: \"paragraph\",\n                    },\n                ],\n            });\n        }\n        var result = {\n            type: \"doc\",\n            content: [],\n        };\n        var blocksGroupedByConverter = groupBy(blocks, function (block) {\n            for (var _i = 0, _a = _this.blockTypes; _i < _a.length; _i++) {\n                var blockType = _a[_i];\n                if (blockType.canParse(_this.schema, block)) {\n                    return blockType;\n                }\n            }\n        });\n        for (var _i = 0, blocksGroupedByConverter_1 = blocksGroupedByConverter; _i < blocksGroupedByConverter_1.length; _i++) {\n            var group = blocksGroupedByConverter_1[_i];\n            var parsedNodes = group.group.parse(this.schema, group.items);\n            result.content = result.content.concat.apply(result.content, parsedNodes);\n        }\n        return Node.fromJSON(this.schema, result);\n    };\n    JSONLanguage.prototype.createSchema = function (options) {\n        var schema = _super.prototype.createSchema.call(this, options);\n        return new Schema({\n            nodes: schema.spec.nodes\n                .addBefore(\"image\", \"dc-image-link\", DcImageLinkNode())\n                .addBefore(\"image\", \"dc-content-link\", DcContentLinkNode()),\n            marks: schema.spec.marks,\n        });\n    };\n    JSONLanguage.prototype.getNodeSerializers = function () {\n        return {\n            \"dc-image-link\": function () { return \"\"; },\n            \"dc-content-link\": function () { return \"\"; },\n        };\n    };\n    return JSONLanguage;\n}(MarkdownLanguage));\nexport default JSONLanguage;\nfunction groupBy(items, groupFn) {\n    var result = [];\n    var currentGroup = null;\n    var currentGroupItems = [];\n    for (var _i = 0, items_1 = items; _i < items_1.length; _i++) {\n        var item = items_1[_i];\n        var itemGroup = groupFn(item);\n        if (itemGroup === undefined) {\n            continue;\n        }\n        if (currentGroup === null) {\n            currentGroup = itemGroup;\n            currentGroupItems = [item];\n        }\n        else if (currentGroup === itemGroup) {\n            currentGroupItems.push(item);\n        }\n        else {\n            if (currentGroupItems.length > 0) {\n                result.push({\n                    group: currentGroup,\n                    items: currentGroupItems,\n                });\n            }\n            currentGroup = itemGroup;\n            currentGroupItems = [item];\n        }\n    }\n    if (currentGroupItems.length > 0 && currentGroup !== null) {\n        result.push({\n            group: currentGroup,\n            items: currentGroupItems,\n        });\n    }\n    return result;\n}\n"],"sourceRoot":""}